import{y as J,H as Fe,J as Le,j as e,B as v,au as _e,V as Me,z as De,r as y,aw as A,a as Qe,W as Ve,M as S,C as V,b as B,c as U,e as G,L as x,I as f,as as me}from"./index-OpUgwHtL.js";import{F as H}from"./status.constants-DWy2VQ0O.js";import{u as Be}from"./useScrollToError-CSOXzexq.js";import{u as Ue}from"./useMutation-D6oTzj3K.js";import{c as Ge,d as He,e as qe,f as $e,g as We,h as ze,i as Ye}from"./inspection.queries-1adENar4.js";import{u as Ke,M as Je}from"./MaterialTypeSelect-B7QQ5jHh.js";import{a as T,W as z,F as Y}from"./qc.constants-BiZsKRrC.js";import{A as pe}from"./arrow-left-BNrJkLJ8.js";import{C as Xe}from"./circle-alert-D_a3WyVG.js";import{F as K}from"./file-text-DAy5e-_n.js";import{P as ue}from"./paperclip-DRDBR-Ua.js";import{E as he}from"./external-link-BdBhnDn5.js";import{C as xe}from"./circle-check-dyjDsZWX.js";import{C as Ze}from"./circle-x-BCYOunZn.js";import{S as es}from"./send-B0q_T_t-.js";import"./triangle-alert-CGTyW-zG.js";import"./clock-TTukqNKw.js";import"./SearchableSelect-B8bd_uIB.js";import"./plus-DHn7uGgA.js";import"./materialType.queries-BSTulka1.js";import"./user-check-CRxqSjm5.js";const ss=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]],as=J("pencil",ss);const ts=[["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["path",{d:"M6 9V3a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v6",key:"1itne7"}],["rect",{x:"6",y:"14",width:"12",height:"8",rx:"1",key:"1ue0tg"}]],rs=J("printer",ts);const is=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],ns=J("save",is),ls={async getById(c){return(await Fe.get(Le.QUALITY_CONTROL_V2.ARRIVAL_SLIP_BY_ID(c))).data}},fe={all:["qc-arrivalSlips"],detail:c=>[...fe.all,"detail",c]};function cs(c){return Ue({queryKey:fe.detail(c),queryFn:()=>ls.getById(c),enabled:!!c})}const os={chemist:{title:"Approved by QC Chemist",subtitle:"Inspection has been approved and forwarded to QC Manager"},manager:{title:"Approved by QC Manager",subtitle:"Quality control inspection is now complete"}};function ds({type:c,onNavigateToDashboard:_,onNavigateToHome:P}){const g=os[c];return e.jsxs("div",{className:"fixed inset-0 z-50 flex flex-col items-center justify-center bg-background",children:[e.jsx("div",{className:"relative mb-8",children:e.jsxs("svg",{className:"h-32 w-32 text-green-500",viewBox:"0 0 100 100",children:[e.jsx("circle",{cx:"50",cy:"50",r:"45",fill:"none",stroke:"currentColor",strokeWidth:"4",className:"animate-draw-circle",style:{strokeDasharray:283,strokeDashoffset:283}}),e.jsx("path",{d:"M30 50 L45 65 L70 35",fill:"none",stroke:"currentColor",strokeWidth:"5",strokeLinecap:"round",strokeLinejoin:"round",className:"animate-draw-check",style:{strokeDasharray:60,strokeDashoffset:60}})]})}),e.jsx("h1",{className:"mb-2 text-3xl font-bold text-foreground opacity-0 animate-fade-in-delay-1",children:g.title}),e.jsx("p",{className:"mb-12 text-muted-foreground opacity-0 animate-fade-in-delay-2",children:g.subtitle}),e.jsxs("div",{className:"flex flex-col gap-4 sm:flex-row opacity-0 animate-fade-in-delay-3",children:[e.jsxs(v,{size:"lg",onClick:_,className:"min-w-[200px]",children:[e.jsx(_e,{className:"mr-2 h-5 w-5"}),"QC Dashboard"]}),e.jsxs(v,{size:"lg",variant:"outline",onClick:P,className:"min-w-[200px]",children:[e.jsx(Me,{className:"mr-2 h-5 w-5"}),"Home"]})]})]})}function ms(c){const{hasAnyPermission:_}=De();return y.useMemo(()=>{const P=_([A.INSPECTION.CREATE]),g=_([A.INSPECTION.CREATE,A.INSPECTION.EDIT]),k=_([A.INSPECTION.SUBMIT]),E=_([A.APPROVAL.APPROVE_AS_CHEMIST]),F=_([A.APPROVAL.APPROVE_AS_QAM]),t=_([A.APPROVAL.REJECT,A.APPROVAL.APPROVE_AS_CHEMIST,A.APPROVAL.APPROVE_AS_QAM]),L=!c||c.workflow_status===T.DRAFT,o=c?.workflow_status===T.SUBMITTED,q=c?.workflow_status===T.QA_CHEMIST_APPROVED,p=c?.is_locked??!1,M=c?.workflow_status===T.QAM_APPROVED||c?.workflow_status===T.REJECTED;return{canCreateInspection:P,canEditInspection:g,canSubmitInspection:k,canApproveAsChemist:E,canApproveAsQAM:F,canReject:t,showSaveButton:!p&&L&&g,showSubmitButton:c&&L&&!p&&k,showChemistApproval:o&&E,showQAMApproval:q&&F,showRejectButton:(o||q)&&t,canEditFields:!p&&L&&g,isCompleted:M,isLocked:p}},[c,_])}function Os(){const c=Qe(),{slipId:_,inspectionId:P}=Ve(),g=window.location.pathname.includes("/new"),k=_?parseInt(_):P?parseInt(P):null,[E,F]=y.useState(!1),{data:t,isLoading:L}=Ge(k),{data:o,isLoading:q}=cs(k),[p,M]=y.useState({inspection_date:new Date().toISOString().split("T")[0],description_of_material:"",sap_code:"",supplier_name:"",manufacturer_name:"",supplier_batch_lot_no:"",unit_packing:"",purchase_order_no:"",internal_lot_no:"",invoice_bill_no:"",vehicle_no:"",material_type_id:0,remarks:""}),[D,X]=y.useState({}),[Q,je]=y.useState(""),[Z,ve]=y.useState(H.ACCEPTED),[N,d]=y.useState({}),[ee,se]=y.useState(null);Be(N);const{data:R=[]}=Ke(p.material_type_id||null),ae=He(),te=qe(),re=$e(),ie=We(),ne=ze(),le=Ye();y.useEffect(()=>{if(t){M({inspection_date:t.inspection_date,description_of_material:t.description_of_material,sap_code:t.sap_code,supplier_name:t.supplier_name,manufacturer_name:t.manufacturer_name,supplier_batch_lot_no:t.supplier_batch_lot_no,unit_packing:t.unit_packing,purchase_order_no:t.purchase_order_no,internal_lot_no:t.internal_lot_no,invoice_bill_no:t.invoice_bill_no,vehicle_no:t.vehicle_no,material_type_id:t.material_type,remarks:t.remarks});const s={};t.parameter_results?.forEach(a=>{s[a.parameter_master]={result_value:a.result_value,result_numeric:a.result_numeric||void 0,is_within_spec:a.is_within_spec??void 0,remarks:a.remarks}}),X(s)}},[t]),y.useEffect(()=>{o&&!t&&g&&M(s=>({...s,description_of_material:o.item_name||s.description_of_material,sap_code:o.po_item_code||s.sap_code,supplier_name:o.party_name||s.supplier_name,unit_packing:o.billing_qty&&o.billing_uom?`${o.billing_qty} ${o.billing_uom}`:s.unit_packing,vehicle_no:o.truck_no_as_per_bill||s.vehicle_no,invoice_bill_no:o.commercial_invoice_no||s.invoice_bill_no,remarks:o.remarks||s.remarks}))},[o,t,g]);const j=(s,a)=>{M(i=>({...i,[s]:a})),N[s]&&d(i=>{const n={...i};return delete n[s],n})},C=(s,a,i)=>{X(r=>({...r,[s]:{...r[s],result_value:r[s]?.result_value||"",remarks:r[s]?.remarks||"",[a]:i}}));const n=`param_${s}`;N[n]&&d(r=>{const h={...r};return delete h[n],h})},$=(s,a,i,n,r)=>{if(C(s,"result_value",a),i==="NUMERIC"||i==="RANGE"){const h=parseFloat(a);if(!isNaN(h)&&(C(s,"result_numeric",h),i==="RANGE"&&n!=null&&r!=null)){const O=typeof n=="string"?parseFloat(n):n,I=typeof r=="string"?parseFloat(r):r;!isNaN(O)&&!isNaN(I)&&C(s,"is_within_spec",h>=O&&h<=I)}}else i==="BOOLEAN"&&C(s,"is_within_spec",a==="Pass")},ce=s=>{switch(s){case"NUMERIC":return"Enter numeric value";case"RANGE":return"Enter numeric value";case"BOOLEAN":return"Select Pass or Fail";default:return"Enter text value"}},ge=async()=>{if(k)try{d({});const s={};p.material_type_id||(s.material_type_id="Please select a material type");const a=R.filter(n=>n.is_mandatory);for(const n of a)D[n.id]?.result_value?.trim()||(s[`param_${n.id}`]=`${n.parameter_name} result is required`);if(Object.keys(s).length>0){d(s);return}let i=t?.id;if(t||(i=(await ae.mutateAsync({slipId:k,data:p})).id),i&&Object.keys(D).length>0){const n=Object.entries(D).map(([r,h])=>({parameter_master_id:parseInt(r),result_value:h.result_value||"",result_numeric:h.result_numeric,is_within_spec:h.is_within_spec??!0,remarks:h.remarks||""}));await te.mutateAsync({inspectionId:i,results:n})}F(!1)}catch(s){const a=s;if(a.errors){const i={};Object.entries(a.errors).forEach(([n,r])=>{i[n]=r[0]}),d(i)}else d({general:a.message||"Failed to save inspection"})}},Ne=async()=>{if(!t){d({general:"Please save the inspection first"});return}try{d({}),await re.mutateAsync(t.id)}catch(s){const a=s;if(a.errors){const i={};Object.entries(a.errors).forEach(([n,r])=>{i[n]=r[0]}),d(i)}else d({general:a.message||"Failed to submit inspection"})}},be=async()=>{if(t)try{d({}),await ie.mutateAsync({id:t.id,data:{remarks:Q}}),se("chemist")}catch(s){const a=s;if(a.errors){const i={};Object.entries(a.errors).forEach(([n,r])=>{i[n]=r[0]}),d(i)}else d({general:a.message||"Failed to approve"})}},ye=async()=>{if(t)try{d({}),await ne.mutateAsync({id:t.id,data:{remarks:Q,final_status:Z}}),se("manager")}catch(s){const a=s;if(a.errors){const i={};Object.entries(a.errors).forEach(([n,r])=>{i[n]=r[0]}),d(i)}else d({general:a.message||"Failed to approve"})}},we=async()=>{if(t){if(!Q.trim()){d({approval_remarks:"Please provide a reason for rejection"});return}try{d({}),await le.mutateAsync({id:t.id,data:{remarks:Q}})}catch(s){const a=s;if(a.errors){const i={};Object.entries(a.errors).forEach(([n,r])=>{i[n]=r[0]}),d(i)}else d({general:a.message||"Failed to reject"})}}},{canEditInspection:Ae,showSubmitButton:Ce,showChemistApproval:ke,showQAMApproval:Ee,showRejectButton:Ie,canEditFields:Se,isLocked:Pe}=ms(t),Re=!t||t.workflow_status===T.DRAFT,m=Se&&(!t||E),Oe=t&&Re&&Ae&&!E&&!Pe,Te=Ce&&!E,oe=ke,W=Ee,de=Ie,l=ae.isPending||te.isPending||re.isPending||ie.isPending||ne.isPending||le.isPending;return ee?e.jsx(ds,{type:ee,onNavigateToDashboard:()=>c("/qc"),onNavigateToHome:()=>c("/")}):L||q?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"h-8 w-8 animate-spin rounded-full border-4 border-primary border-t-transparent"})}):e.jsxs("div",{className:"space-y-6 pb-6",children:[e.jsx("div",{className:"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between print-no-break",children:e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(v,{variant:"ghost",size:"sm",onClick:()=>c("/qc/pending"),children:e.jsx(pe,{className:"h-4 w-4"})}),e.jsxs("h2",{className:"text-3xl font-bold tracking-tight flex items-center gap-3",children:[e.jsx(_e,{className:"h-8 w-8"}),g?"New Inspection":"Inspection Details"]})]}),t&&e.jsxs("div",{className:"flex items-center gap-4 ml-10",children:[e.jsxs("span",{className:"text-muted-foreground",children:["Report No: ",t.report_no]}),e.jsx("span",{className:S("px-2 py-1 rounded-full text-xs font-medium",z[t.workflow_status].bgColor,z[t.workflow_status].color),children:z[t.workflow_status].label}),t.final_status!==H.PENDING&&e.jsx("span",{className:S("px-2 py-1 rounded-full text-xs font-medium",Y[t.final_status].bgColor,Y[t.final_status].color),children:Y[t.final_status].label})]})]})}),N.general&&e.jsxs("div",{className:"rounded-md bg-destructive/15 p-3 text-sm text-destructive flex items-center gap-2",children:[e.jsx(Xe,{className:"h-4 w-4"}),N.general]}),e.jsxs(V,{children:[e.jsx(B,{children:e.jsxs(U,{className:"flex items-center gap-2",children:[e.jsx(K,{className:"h-5 w-5"}),"Inspection Information"]})}),e.jsx(G,{children:e.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{children:"Description of Material"}),e.jsx(f,{value:p.description_of_material||"",onChange:s=>j("description_of_material",s.target.value),disabled:!m||l})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{children:"SAP Code"}),e.jsx(f,{value:p.sap_code||"",onChange:s=>j("sap_code",s.target.value),disabled:!m||l})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{children:"Supplier Name"}),e.jsx(f,{value:p.supplier_name||"",onChange:s=>j("supplier_name",s.target.value),disabled:!m||l})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{children:"Unit Packing"}),e.jsx(f,{value:p.unit_packing||"",onChange:s=>j("unit_packing",s.target.value),disabled:!m||l})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{children:"Vehicle No."}),e.jsx(f,{value:p.vehicle_no||"",onChange:s=>j("vehicle_no",s.target.value),disabled:!m||l})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{children:"Commercial Invoice No."}),e.jsx(f,{value:p.invoice_bill_no||"",onChange:s=>j("invoice_bill_no",s.target.value),disabled:!m||l})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{children:"Inspection Date"}),e.jsx(f,{type:"date",value:p.inspection_date||"",onChange:s=>j("inspection_date",s.target.value),disabled:!m||l})]}),e.jsx(Je,{label:"Material Type",required:!0,value:p.material_type_id||void 0,onChange:s=>j("material_type_id",s?.id||0),disabled:!m||l||!!t,error:N.material_type_id}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{children:"Internal Lot No."}),e.jsx(f,{value:p.internal_lot_no||"",onChange:s=>j("internal_lot_no",s.target.value),disabled:!m||l})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{children:"Supplier Batch/Lot No."}),e.jsx(f,{value:p.supplier_batch_lot_no||"",onChange:s=>j("supplier_batch_lot_no",s.target.value),disabled:!m||l})]}),e.jsxs("div",{className:"space-y-2 md:col-span-2 lg:col-span-3",children:[e.jsx(x,{children:"Remarks"}),e.jsx(me,{value:p.remarks||"",onChange:s=>j("remarks",s.target.value),disabled:!m||l,rows:2})]})]})})]}),o&&o.attachments?.some(s=>s.attachment_type==="CERTIFICATE_OF_ANALYSIS")&&e.jsxs(V,{className:"print-page-break",children:[e.jsx(B,{children:e.jsxs(U,{className:"flex items-center gap-2",children:[e.jsx(ue,{className:"h-5 w-5"}),"Certificate of Analysis (COA)"]})}),e.jsx(G,{children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:o.attachments.filter(s=>s.attachment_type==="CERTIFICATE_OF_ANALYSIS").map(s=>{const a=/\.(jpg|jpeg|png|gif|webp|bmp|svg)(\?.*)?$/i.test(s.file);return e.jsx("a",{href:s.file,target:"_blank",rel:"noopener noreferrer",className:"block border rounded-lg overflow-hidden hover:ring-2 hover:ring-primary transition-all",children:a?e.jsx("img",{src:s.file,alt:"Certificate of Analysis",className:"w-full print-attachment-img"}):e.jsxs("div",{className:"w-full h-48 flex flex-col items-center justify-center gap-2 bg-muted/30 text-muted-foreground",children:[e.jsx(K,{className:"h-8 w-8"}),e.jsx("span",{className:"text-xs",children:"View File"}),e.jsx(he,{className:"h-3 w-3"})]})},s.id)})})})]}),o&&o.attachments?.some(s=>s.attachment_type==="CERTIFICATE_OF_QUANTITY")&&e.jsxs(V,{className:"print-page-break",children:[e.jsx(B,{children:e.jsxs(U,{className:"flex items-center gap-2",children:[e.jsx(ue,{className:"h-5 w-5"}),"Certificate of Quantity (COQ)"]})}),e.jsx(G,{children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:o.attachments.filter(s=>s.attachment_type==="CERTIFICATE_OF_QUANTITY").map(s=>{const a=/\.(jpg|jpeg|png|gif|webp|bmp|svg)(\?.*)?$/i.test(s.file);return e.jsx("a",{href:s.file,target:"_blank",rel:"noopener noreferrer",className:"block border rounded-lg overflow-hidden hover:ring-2 hover:ring-primary transition-all",children:a?e.jsx("img",{src:s.file,alt:"Certificate of Quantity",className:"w-full print-attachment-img"}):e.jsxs("div",{className:"w-full h-48 flex flex-col items-center justify-center gap-2 bg-muted/30 text-muted-foreground",children:[e.jsx(K,{className:"h-8 w-8"}),e.jsx("span",{className:"text-xs",children:"View File"}),e.jsx(he,{className:"h-3 w-3"})]})},s.id)})})})]}),((t?.parameter_results?.length??0)>0||R.length>0)&&e.jsxs(V,{children:[e.jsx(B,{children:e.jsx(U,{children:"QC Parameters"})}),e.jsxs(G,{children:[e.jsx("div",{className:"md:hidden space-y-4",children:(t?.parameter_results||R).map(s=>{const a="parameter_master"in s?s.parameter_master:s.id,i=s.parameter_name,n=s.standard_value,r=s.parameter_type,h=s.min_value,O=s.max_value,I="is_mandatory"in s?s.is_mandatory:R.find(u=>u.id===a)?.is_mandatory??!1,b=N[`param_${a}`],w=D[a]||{result_value:"",is_within_spec:!0,remarks:""};return e.jsxs("div",{className:S("border rounded-lg p-3 space-y-3",b&&"border-destructive"),children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"font-medium text-sm",children:[i,I&&e.jsx("span",{className:"text-destructive",children:" *"})]}),e.jsxs("label",{className:"flex items-center gap-2 text-sm",children:[e.jsx("input",{type:"checkbox",checked:w.is_within_spec??!0,onChange:u=>C(a,"is_within_spec",u.target.checked),disabled:!m||l||r==="BOOLEAN"||r==="RANGE",className:"h-4 w-4 rounded border-gray-300"}),e.jsx("span",{className:"text-muted-foreground",children:"Within Spec"})]})]}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Standard: ",n]}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs(x,{className:"text-xs",children:["Result",I&&e.jsx("span",{className:"text-destructive",children:" *"})]}),r==="BOOLEAN"?e.jsxs("select",{value:w.result_value,onChange:u=>$(a,u.target.value,r),disabled:!m||l,className:S("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm",b&&"border-destructive"),children:[e.jsx("option",{value:"",children:"Select Pass or Fail"}),e.jsx("option",{value:"Pass",children:"Pass"}),e.jsx("option",{value:"Fail",children:"Fail"})]}):e.jsx(f,{type:r==="NUMERIC"||r==="RANGE"?"number":"text",step:r==="NUMERIC"||r==="RANGE"?"any":void 0,value:w.result_value,onChange:u=>$(a,u.target.value,r,h,O),disabled:!m||l,className:S("w-full",b&&"border-destructive"),placeholder:ce(r)}),b&&e.jsx("p",{className:"text-xs text-destructive",children:b})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(x,{className:"text-xs",children:"Remarks"}),e.jsx(f,{value:w.remarks,onChange:u=>C(a,"remarks",u.target.value),disabled:!m||l,className:"w-full",placeholder:"Optional"})]})]},a)})}),e.jsx("div",{className:"hidden md:block overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b bg-muted/50",children:[e.jsx("th",{className:"text-left p-3 font-medium",children:"Parameter"}),e.jsx("th",{className:"text-left p-3 font-medium",children:"Standard Value"}),e.jsx("th",{className:"text-left p-3 font-medium",children:"Result"}),e.jsx("th",{className:"text-center p-3 font-medium",children:"Within Spec"}),e.jsx("th",{className:"text-left p-3 font-medium",children:"Remarks"})]})}),e.jsx("tbody",{children:(t?.parameter_results||R).map(s=>{const a="parameter_master"in s?s.parameter_master:s.id,i=s.parameter_name,n=s.standard_value,r=s.parameter_type,h=s.min_value,O=s.max_value,I="is_mandatory"in s?s.is_mandatory:R.find(u=>u.id===a)?.is_mandatory??!1,b=N[`param_${a}`],w=D[a]||{result_value:"",is_within_spec:!0,remarks:""};return e.jsxs("tr",{className:"border-b",children:[e.jsx("td",{className:"p-3",children:e.jsxs("span",{className:"font-medium",children:[i,I&&e.jsx("span",{className:"text-destructive",children:" *"})]})}),e.jsx("td",{className:"p-3 text-muted-foreground",children:n}),e.jsxs("td",{className:"p-3",children:[r==="BOOLEAN"?e.jsxs("select",{value:w.result_value,onChange:u=>$(a,u.target.value,r),disabled:!m||l,className:S("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm",b&&"border-destructive"),children:[e.jsx("option",{value:"",children:"Select Pass or Fail"}),e.jsx("option",{value:"Pass",children:"Pass"}),e.jsx("option",{value:"Fail",children:"Fail"})]}):e.jsx(f,{type:r==="NUMERIC"||r==="RANGE"?"number":"text",step:r==="NUMERIC"||r==="RANGE"?"any":void 0,value:w.result_value,onChange:u=>$(a,u.target.value,r,h,O),disabled:!m||l,className:S("w-full",b&&"border-destructive"),placeholder:ce(r)}),b&&e.jsx("p",{className:"text-xs text-destructive mt-1",children:b})]}),e.jsx("td",{className:"p-3 text-center",children:e.jsx("input",{type:"checkbox",checked:w.is_within_spec??!0,onChange:u=>C(a,"is_within_spec",u.target.checked),disabled:!m||l||r==="BOOLEAN"||r==="RANGE",className:"h-4 w-4 rounded border-gray-300"})}),e.jsx("td",{className:"p-3",children:e.jsx(f,{value:w.remarks,onChange:u=>C(a,"remarks",u.target.value),disabled:!m||l,className:"w-full",placeholder:"Optional"})})]},a)})})]})})]})]}),(oe||W||de)&&e.jsxs(V,{className:"border-primary/50",children:[e.jsx(B,{children:e.jsx(U,{children:"Approval"})}),e.jsxs(G,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{children:"Remarks"}),e.jsx(me,{value:Q,onChange:s=>je(s.target.value),placeholder:"Enter approval/rejection remarks",rows:3}),N.approval_remarks&&e.jsx("p",{className:"text-sm text-destructive",children:N.approval_remarks})]}),W&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{children:"Final Status"}),e.jsxs("select",{className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm",value:Z,onChange:s=>ve(s.target.value),children:[e.jsx("option",{value:H.ACCEPTED,children:"Accepted"}),e.jsx("option",{value:H.REJECTED,children:"Rejected"}),e.jsx("option",{value:H.HOLD,children:"Hold"})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-4",children:[oe&&e.jsxs(v,{onClick:be,disabled:l,children:[e.jsx(xe,{className:"h-4 w-4 mr-2"}),"Approve as Chemist"]}),W&&e.jsxs(v,{onClick:ye,disabled:l,children:[e.jsx(xe,{className:"h-4 w-4 mr-2"}),"Approve as Manager"]}),de&&e.jsxs(v,{variant:"destructive",onClick:we,disabled:l,children:[e.jsx(Ze,{className:"h-4 w-4 mr-2"}),"Reject"]})]})]})]}),e.jsxs("div",{className:"flex flex-col-reverse gap-4 sm:flex-row sm:justify-between print-hide",children:[e.jsxs(v,{variant:"outline",onClick:()=>c("/qc/pending"),children:[e.jsx(pe,{className:"h-4 w-4 mr-2"}),"Back"]}),e.jsxs("div",{className:"flex gap-4",children:[t&&e.jsxs(v,{variant:"outline",onClick:()=>window.print(),children:[e.jsx(rs,{className:"h-4 w-4 mr-2"}),"Print"]}),Oe&&e.jsxs(v,{variant:"outline",onClick:()=>F(!0),children:[e.jsx(as,{className:"h-4 w-4 mr-2"}),"Update"]}),m&&e.jsxs(v,{onClick:ge,disabled:l,children:[e.jsx(ns,{className:"h-4 w-4 mr-2"}),l?"Saving...":"Save"]}),Te&&!E&&e.jsxs(v,{onClick:Ne,disabled:l,children:[e.jsx(es,{className:"h-4 w-4 mr-2"}),"Submit for Approval"]})]})]})]})}export{Os as default};
