import{a as E,r as c,j as e,B as d,au as S,C as b,e as T,b as P,c as k,D as F,m as L,n as q,o as O,L as h,I as u,q as B}from"./index-BJbr7dGT.js";import{u as z}from"./useScrollToError-ByUJimjt.js";import{u as I,a as H,b as U,c as Q}from"./materialType.queries-B4zSYwI7.js";import{A as R}from"./arrow-left-CSneh59K.js";import{P as _}from"./plus-CkmVnUnI.js";import{C as G}from"./circle-alert-DDfM1UF8.js";import{S as J}from"./square-pen-Ycrh5ZPV.js";import{T as K}from"./trash-2-BCIspCd8.js";import"./useMutation-B7kknB8H.js";function ie(){const w=E(),{data:o=[],isLoading:j,error:g}=I(),[D,m]=c.useState(!1),[x,p]=c.useState(null),[t,r]=c.useState({code:"",name:"",description:""}),[i,l]=c.useState({});z(i);const f=H(),N=U(),v=Q(),y=s=>{s?(p(s),r({code:s.code,name:s.name,description:s.description||""})):(p(null),r({code:"",name:"",description:""})),l({}),m(!0)},C=()=>{m(!1),p(null),r({code:"",name:"",description:""}),l({})},M=async()=>{if(!t.code.trim()){l({code:"Code is required"});return}if(!t.name.trim()){l({name:"Name is required"});return}try{l({}),x?await N.mutateAsync({id:x.id,data:t}):await f.mutateAsync(t),C()}catch(s){l({general:s.message||"Failed to save material type"})}},A=async s=>{if(confirm("Are you sure you want to delete this material type?"))try{await v.mutateAsync(s)}catch(a){alert(a.message||"Failed to delete material type")}},n=f.isPending||N.isPending;return e.jsxs("div",{className:"space-y-6 pb-6",children:[e.jsxs("div",{className:"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(d,{variant:"ghost",size:"sm",onClick:()=>w("/qc"),children:e.jsx(R,{className:"h-4 w-4"})}),e.jsxs("h2",{className:"text-3xl font-bold tracking-tight flex items-center gap-3",children:[e.jsx(S,{className:"h-8 w-8"}),"Material Types"]})]}),e.jsx("p",{className:"text-muted-foreground",children:"Manage material type definitions for QC inspections"})]}),e.jsxs(d,{onClick:()=>y(),children:[e.jsx(_,{className:"h-4 w-4 mr-2"}),"Add Material Type"]})]}),g&&e.jsxs("div",{className:"rounded-md bg-destructive/15 p-4 text-sm text-destructive flex items-center gap-2",children:[e.jsx(G,{className:"h-4 w-4"}),"Failed to load material types. Please try again."]}),j&&e.jsx(b,{children:e.jsx(T,{className:"py-12",children:e.jsxs("div",{className:"flex flex-col items-center justify-center gap-4",children:[e.jsx("div",{className:"h-8 w-8 animate-spin rounded-full border-4 border-primary border-t-transparent"}),e.jsx("p",{className:"text-muted-foreground",children:"Loading..."})]})})}),!j&&!g&&e.jsxs(b,{children:[e.jsx(P,{children:e.jsxs(k,{children:["Material Types (",o.length,")"]})}),e.jsx(T,{children:o.length===0?e.jsx("div",{className:"py-8 text-center text-muted-foreground",children:'No material types found. Click "Add Material Type" to create one.'}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b bg-muted/50",children:[e.jsx("th",{className:"text-left p-3 font-medium",children:"Code"}),e.jsx("th",{className:"text-left p-3 font-medium",children:"Name"}),e.jsx("th",{className:"text-left p-3 font-medium",children:"Description"}),e.jsx("th",{className:"text-center p-3 font-medium",children:"Actions"})]})}),e.jsx("tbody",{children:o.map(s=>e.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[e.jsx("td",{className:"p-3 font-medium",children:s.code}),e.jsx("td",{className:"p-3",children:s.name}),e.jsx("td",{className:"p-3 text-muted-foreground",children:s.description||"-"}),e.jsx("td",{className:"p-3 text-center",children:e.jsxs("div",{className:"flex justify-center gap-2",children:[e.jsx(d,{size:"sm",variant:"outline",onClick:()=>y(s),children:e.jsx(J,{className:"h-4 w-4"})}),e.jsx(d,{size:"sm",variant:"outline",onClick:()=>A(s.id),disabled:v.isPending,children:e.jsx(K,{className:"h-4 w-4"})})]})})]},s.id))})]})})})]}),e.jsx(F,{open:D,onOpenChange:m,children:e.jsxs(L,{children:[e.jsx(q,{children:e.jsx(O,{children:x?"Edit Material Type":"Add Material Type"})}),i.general&&e.jsx("div",{className:"rounded-md bg-destructive/15 p-3 text-sm text-destructive",children:i.general}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{children:"Code"}),e.jsx(u,{value:t.code,onChange:s=>r(a=>({...a,code:s.target.value})),placeholder:"e.g., CAP_BLUE",disabled:n}),i.code&&e.jsx("p",{className:"text-sm text-destructive",children:i.code})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{children:"Name"}),e.jsx(u,{value:t.name,onChange:s=>r(a=>({...a,name:s.target.value})),placeholder:"e.g., Cap Blue Plain",disabled:n}),i.name&&e.jsx("p",{className:"text-sm text-destructive",children:i.name})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{children:"Description"}),e.jsx(u,{value:t.description||"",onChange:s=>r(a=>({...a,description:s.target.value})),placeholder:"Optional description",disabled:n})]})]}),e.jsxs(B,{children:[e.jsx(d,{variant:"outline",onClick:C,disabled:n,children:"Cancel"}),e.jsx(d,{onClick:M,disabled:n,children:n?"Saving...":"Save"})]})]})})]})}export{ie as default};
