import{y as ae,r as t,j as s,L as Q,$ as oe,a0 as le,a1 as ie,I as ue,M as y,O as W,N as de,B as fe,k as xe}from"./index-DfliZ1OU.js";import{P as he}from"./plus-CMKK_uBk.js";const me=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]],pe=ae("circle-question-mark",me);function je(n,a){const[d,f]=t.useState(n);return t.useEffect(()=>{const p=setTimeout(()=>{f(n)},a);return()=>{clearTimeout(p)}},[n,a]),d}function ge({value:n,items:a,isLoading:d,isError:f=!1,placeholder:p="Select...",disabled:j=!1,error:N,label:v,required:S=!1,inputId:g,inputClassName:$,defaultDisplayText:o,getItemKey:x,getItemLabel:l,renderItem:R,filterFn:q,renderPopoverContent:E,loadingText:G,emptyText:H,notFoundText:J,addNewLabel:F,errorText:K="Failed to load. Please try again.",onItemSelect:T,onClear:U,onOpenChange:P,onSelectedKeyChange:O,renderCreateDialog:M}){const[h,X]=t.useState(!1),[Y,V]=t.useState(!1),[k,i]=t.useState(o||""),[D,Z]=t.useState(null),w=t.useRef(null),L=t.useRef(null),C=t.useRef(n),z=t.useRef(o),I=je(k,100),ee=t.useCallback((e,c)=>l(e).toLowerCase().includes(c.toLowerCase()),[l]),se=q||ee,m=a.filter(e=>se(e,I)),r=t.useCallback(e=>{X(e),P?.(e)},[P]),u=t.useCallback(e=>{Z(e),O?.(e)},[O]);t.useEffect(()=>{o!==z.current&&(z.current=o,o&&i(o))},[o]);const B=t.useCallback(()=>{if(j&&n){i(n);return}if(n&&a.length>0){const e=a.find(c=>l(c)===n||String(x(c))===n);e&&(u(x(e)),i(l(e)))}else n!==C.current&&!n&&(C.current=n,u(null),i(""))},[n,a,j,l,x,u]);t.useEffect(()=>{B(),C.current=n},[B,n]),t.useEffect(()=>{const e=c=>{w.current&&!w.current.contains(c.target)&&r(!1)};if(h)return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[h,r]);const _=e=>{u(x(e)),i(l(e)),T(e),r(!1)},te=e=>{i(e.target.value),r(!0),e.target.value||(U(),u(null))},ne=e=>{e.key==="Escape"?r(!1):e.key==="Enter"&&m.length===1&&_(m[0])},ce=e=>{e.stopPropagation(),r(!1),V(!0)},re=t.useCallback((e,c)=>{u(e),i(c),r(!1)},[u,r]),A=F&&M;return s.jsxs("div",{className:"space-y-2",children:[v&&(E?s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsxs(Q,{htmlFor:g,children:[v," ",S&&s.jsx("span",{className:"text-destructive",children:"*"})]}),s.jsxs(oe,{children:[s.jsx(le,{asChild:!0,children:s.jsx("button",{type:"button",className:"inline-flex items-center justify-center rounded-full text-muted-foreground hover:text-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",onClick:e=>e.stopPropagation(),children:s.jsx(pe,{className:"h-4 w-4"})})}),s.jsx(ie,{className:"w-80",align:"start",children:E(D)})]})]}):s.jsxs(Q,{htmlFor:g,children:[v," ",S&&s.jsx("span",{className:"text-destructive",children:"*"})]})),s.jsxs("div",{ref:w,className:"relative",children:[s.jsxs("div",{className:"relative",children:[s.jsx(ue,{ref:L,id:g,type:"text",value:k,onChange:te,onFocus:()=>r(!0),onKeyDown:ne,placeholder:p,disabled:j||d&&!f,className:y("pr-10 cursor-text",$,N&&"border-destructive focus-visible:ring-destructive"),autoComplete:"off"}),s.jsx("div",{className:"absolute right-3 top-1/2 -translate-y-1/2 pointer-events-none",children:d&&!f?s.jsx(W,{className:"h-4 w-4 animate-spin text-muted-foreground"}):s.jsx(de,{className:y("h-4 w-4 text-muted-foreground transition-transform",h&&"rotate-180")})})]}),h&&s.jsx("div",{className:"absolute z-50 w-full mt-1 bg-popover border rounded-md shadow-md max-h-60 overflow-auto",children:f?s.jsx("div",{className:"p-4 text-center text-sm text-destructive",children:K}):d?s.jsxs("div",{className:"p-4 text-center text-sm text-muted-foreground",children:[s.jsx(W,{className:"h-4 w-4 animate-spin mx-auto mb-2"}),G]}):s.jsxs(s.Fragment,{children:[A&&s.jsx("div",{className:"px-3 py-2 border-b",children:s.jsxs(fe,{type:"button",variant:"ghost",size:"sm",className:"w-full justify-start text-sm",onClick:ce,children:[s.jsx(he,{className:"h-4 w-4 mr-2"}),F]})}),m.length===0?s.jsx("div",{className:"p-4 text-center text-sm text-muted-foreground",children:k?J:H}):s.jsx("ul",{className:"py-1",children:m.map(e=>{const c=x(e),b=D===c;return s.jsxs("li",{className:y("px-3 py-2 cursor-pointer hover:bg-accent hover:text-accent-foreground flex items-center justify-between",b&&"bg-accent"),onClick:()=>_(e),children:[R?R(e,b):s.jsx("span",{className:"text-sm",children:l(e)}),b&&s.jsx(xe,{className:"h-4 w-4 text-primary"})]},c)})})]})})]}),N&&s.jsx("p",{className:"text-sm text-destructive",children:N}),A&&M(Y,V,re)]})}export{ge as S,je as u};
