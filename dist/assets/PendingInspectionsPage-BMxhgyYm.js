import{a as _,z as k,E as A,r as C,j as e,B as r,Y as R}from"./index-BvEhV83a.js";import{D}from"./DateRangePicker-CWDwl9Ac.js";import"./driver.schema-DO7pkEio.js";import"./vehicle.schema-Cw9NqPJ5.js";import{b as S}from"./inspection.queries-CHltzlNR.js";import{W as E}from"./qc.constants-Dch8RO5m.js";import{A as P}from"./arrow-left-BhC8nzOH.js";import{R as p,S as T}from"./shield-x-Bx1YOo-3.js";import{C as I}from"./circle-alert-DbLcuZGw.js";import"./validation.constants-DHFF3fUR.js";import"./schemas-D8ebsZBL.js";import"./useMutation-CPesZxHy.js";import"./circle-x-CFVAzi2R.js";import"./circle-check-CE0tmuuY.js";import"./user-check-D4vuYEfq.js";import"./send-gfTOHX7f.js";import"./file-text-DDeSXKjR.js";import"./clock-D4zizT_A.js";const l={all:{label:"All",title:"All Inspections",description:"All inspections"},actionable:{label:"Actionable",title:"Pending Actions",description:"Items requiring attention"},pending:{label:"Pending",title:"Pending Inspections",description:"Arrival slips awaiting QC inspection"},draft:{label:"Draft",title:"Draft Inspections",description:"Inspections started but not submitted"},approved:{label:"Approved",title:"Approved Inspections",description:"Completed and approved inspections"},rejected:{label:"Rejected",title:"Rejected Inspections",description:"Rejected inspections"}},O=Object.keys(l),B={NOT_STARTED:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-400",DRAFT:"bg-gray-100 text-gray-800 dark:bg-gray-800 dark:text-gray-300",SUBMITTED:"bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-400",QA_CHEMIST_APPROVED:"bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-400",QAM_APPROVED:"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400",REJECTED:"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-400"};function F(t){return t.inspection_id?`/qc/inspections/${t.arrival_slip_id}`:`/qc/inspections/${t.arrival_slip_id}/new`}function te(){const t=_(),[b,u]=k(),{dateRange:o,dateRangeAsDateObjects:j,setDateRange:g}=A(),w=C.useMemo(()=>({from_date:o.from,to_date:o.to}),[o]),d=b.get("status")||"all",a=l[d]||l.all,{data:n=[],isLoading:c,error:i,refetch:m}=S(d,w),x=i,h=x?.status===403,N=s=>{u(s==="all"?{}:{status:s})},v=s=>{if(!s)return"-";try{return new Date(s).toLocaleString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}catch{return s}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(r,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0",onClick:()=>t("/qc"),children:e.jsx(P,{className:"h-4 w-4"})}),e.jsx("h2",{className:"text-3xl font-bold tracking-tight",children:a.title})]}),e.jsx("p",{className:"text-muted-foreground",children:a.description})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 w-full sm:w-auto",children:[e.jsx(D,{date:j,onDateChange:s=>{s&&"from"in s?g(s):g(void 0)}}),e.jsxs(r,{variant:"outline",size:"sm",onClick:()=>m(),className:"w-full sm:w-auto",children:[e.jsx(p,{className:"h-4 w-4 mr-2"}),"Refresh"]})]})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:O.map(s=>e.jsx(r,{variant:d===s?"default":"outline",size:"sm",className:"h-8",onClick:()=>N(s),children:l[s].label},s))}),h&&e.jsxs("div",{className:"flex items-start gap-3 p-4 rounded-lg border border-destructive/50 bg-destructive/5",children:[e.jsx(T,{className:"h-5 w-5 text-destructive flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium text-destructive",children:"Permission Denied"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:x?.message||"You do not have permission to view pending inspections."})]}),e.jsx(r,{variant:"outline",size:"sm",onClick:()=>m(),children:e.jsx(p,{className:"h-4 w-4"})})]}),i&&!h&&e.jsxs("div",{className:"flex items-start gap-3 p-4 rounded-lg border border-yellow-500/50 bg-yellow-50 dark:bg-yellow-900/10",children:[e.jsx(I,{className:"h-5 w-5 text-yellow-600 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium text-yellow-800 dark:text-yellow-400",children:"Failed to Load"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:x?.message||"An error occurred while loading inspections."})]}),e.jsx(r,{variant:"outline",size:"sm",onClick:()=>m(),children:e.jsx(p,{className:"h-4 w-4"})})]}),c&&e.jsx("div",{className:"flex items-center justify-center h-48",children:e.jsx("div",{className:"h-8 w-8 animate-spin rounded-full border-4 border-primary border-t-transparent"})}),!c&&!i&&n.length===0&&e.jsxs("div",{className:"flex items-center justify-center h-24 text-sm text-muted-foreground border rounded-lg",children:["No ",a.label.toLowerCase()," inspections"]}),!c&&!i&&n.length>0&&e.jsxs("div",{children:[e.jsx("div",{className:"flex items-center justify-between mb-2",children:e.jsxs("h3",{className:"text-sm font-medium text-muted-foreground",children:[a.label," (",n.length,")"]})}),e.jsx("div",{className:"space-y-2",children:n.map(s=>{const f=E[s.workflow_status],y=B[s.workflow_status]||"bg-gray-100 text-gray-800 dark:bg-gray-800 dark:text-gray-300";return e.jsxs("div",{className:"flex items-center justify-between px-3 py-2 rounded-md border bg-card hover:bg-muted/50 transition-colors cursor-pointer",onClick:()=>t(F(s)),children:[e.jsxs("div",{className:"flex items-center gap-3 min-w-0 flex-1",children:[e.jsx("span",{className:"font-medium text-sm",children:s.report_no||s.entry_no}),e.jsx("span",{className:`inline-flex items-center rounded-full px-1.5 py-0.5 text-[10px] font-medium flex-shrink-0 ${y}`,children:f?.label||s.workflow_status}),e.jsxs("span",{className:"text-xs text-muted-foreground hidden md:inline truncate",children:[s.item_name," â€¢ ",s.party_name]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[s.billing_qty&&e.jsxs("span",{className:"text-xs text-muted-foreground hidden sm:inline",children:[s.billing_qty," ",s.billing_uom]}),e.jsx("span",{className:"text-xs text-muted-foreground",children:v(s.submitted_at)}),e.jsx(R,{className:"h-4 w-4 text-muted-foreground"})]})]},s.arrival_slip_id)})})]})]})}export{te as default};
