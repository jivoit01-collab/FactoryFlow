import{a as _,E as D,r as c,j as e,B as R,Y as h,C as T,e as P}from"./index-FTIaQgW5.js";import{g as S}from"./status.constants-Dr0xsafU.js";import{u as L,d as O}from"./vehicleEntry.queries-CpunRUYK.js";import{D as A}from"./DateRangePicker-CBjEk6wE.js";import{C as m}from"./circle-check-Bl6EaNhP.js";import{C as f}from"./clock-CjpRzroy.js";import{F as C}from"./file-text-C43-TAyn.js";import{P as $}from"./plus-Broj2zbo.js";import{C as I}from"./circle-alert-BN4aLgiR.js";import{C as F}from"./circle-x-DPVka7m7.js";const M={statusOrder:["draft","in_progress","completed"],statusConfig:{DRAFT:{label:"Draft",color:"text-yellow-600 dark:text-yellow-400",bgColor:"bg-yellow-50 dark:bg-yellow-900/20 border-yellow-200 dark:border-yellow-800",icon:C},IN_PROGRESS:{label:"In Progress",color:"text-blue-600 dark:text-blue-400",bgColor:"bg-blue-50 dark:bg-blue-900/20 border-blue-200 dark:border-blue-800",icon:f},COMPLETED:{label:"Completed",color:"text-green-600 dark:text-green-400",bgColor:"bg-green-50 dark:bg-green-900/20 border-green-200 dark:border-green-800",icon:m}},gridCols:"grid-cols-3"},z={statusOrder:["draft","in_progress","qc_completed","completed","cancelled","rejected"],statusConfig:{DRAFT:{label:"Draft",color:"text-yellow-600 dark:text-yellow-400",bgColor:"bg-yellow-50 dark:bg-yellow-900/20 border-yellow-200 dark:border-yellow-800",icon:C},IN_PROGRESS:{label:"In Progress",color:"text-blue-600 dark:text-blue-400",bgColor:"bg-blue-50 dark:bg-blue-900/20 border-blue-200 dark:border-blue-800",icon:f},QC_COMPLETED:{label:"QC Completed",color:"text-purple-600 dark:text-purple-400",bgColor:"bg-purple-50 dark:bg-purple-900/20 border-purple-200 dark:border-purple-800",icon:m},COMPLETED:{label:"Completed",color:"text-green-600 dark:text-green-400",bgColor:"bg-green-50 dark:bg-green-900/20 border-green-200 dark:border-green-800",icon:m},CANCELLED:{label:"Cancelled",color:"text-red-600 dark:text-red-400",bgColor:"bg-red-50 dark:bg-red-900/20 border-red-200 dark:border-red-800",icon:F},REJECTED:{label:"Rejected",color:"text-orange-600 dark:text-orange-400",bgColor:"bg-orange-50 dark:bg-orange-900/20 border-orange-200 dark:border-orange-800",icon:I}},gridCols:"grid-cols-2 sm:grid-cols-3 lg:grid-cols-6"};function H({config:o,statusConfig:a=M}){const n=_(),{dateRange:d,dateRangeAsDateObjects:j,setDateRange:u}=D(),x=c.useMemo(()=>({from_date:d.from,to_date:d.to,entry_type:o.entryType}),[d,o.entryType]),{data:N=[],isLoading:w}=L(x),{data:i,isLoading:k}=O(x),y=c.useMemo(()=>{const r={};return a.statusOrder.forEach(s=>{r[s]=0}),i?.total_vehicle_entries&&i.total_vehicle_entries.forEach(({status:s,count:t})=>{const l=s.toLowerCase();l in r&&(r[l]=t)}),r},[i,a.statusOrder]),b=N,g=w||k,p=c.useMemo(()=>[...b].sort((r,s)=>{const t=r.entry_time?new Date(r.entry_time).getTime():0;return(s.entry_time?new Date(s.entry_time).getTime():0)-t}).slice(0,2),[b]),v=r=>{if(!r)return"-";try{return new Date(r).toLocaleString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}catch{return r}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl font-bold tracking-tight",children:o.dashboardTitle}),e.jsx("p",{className:"text-muted-foreground",children:o.dashboardDescription})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 w-full sm:w-auto",children:[e.jsx(A,{date:j,onDateChange:r=>{r&&"from"in r?u(r):u(void 0)}}),e.jsxs(R,{onClick:()=>n(`${o.routePrefix}/new`),className:"w-full sm:w-auto",children:[e.jsx($,{className:"h-4 w-4 mr-2"}),"Add New Entry"]})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h3",{className:"text-sm font-medium text-muted-foreground",children:"Recent Entries"}),e.jsxs("button",{onClick:()=>n(`${o.routePrefix}/all`),className:"text-xs text-muted-foreground hover:text-foreground transition-colors flex items-center gap-1",children:["Show more",e.jsx(h,{className:"h-3 w-3"})]})]}),g?e.jsx("div",{className:"flex items-center justify-center h-16",children:e.jsx("div",{className:"h-5 w-5 animate-spin rounded-full border-2 border-primary border-t-transparent"})}):p.length===0?e.jsx("div",{className:"flex items-center justify-center h-16 text-sm text-muted-foreground border rounded-lg",children:"No entries yet"}):e.jsx("div",{className:"space-y-2",children:p.map(r=>e.jsxs("div",{className:"flex items-center justify-between px-3 py-2 rounded-md border bg-card hover:bg-muted/50 transition-colors cursor-pointer",onClick:()=>n(`${o.routePrefix}/edit/${r.id}/step1`),children:[e.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[e.jsx("span",{className:"font-medium text-sm",children:r.entry_no}),e.jsx("span",{className:`inline-flex items-center rounded-full px-1.5 py-0.5 text-[10px] font-medium ${S(r.status||"")}`,children:r.status}),e.jsxs("span",{className:"text-xs text-muted-foreground hidden sm:inline",children:[r.vehicle?.vehicle_number," â€¢ ",r.driver?.name]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xs text-muted-foreground",children:v(r.entry_time)}),e.jsx(h,{className:"h-4 w-4 text-muted-foreground"})]})]},r.id))})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-muted-foreground mb-3",children:"Status Overview"}),g?e.jsx("div",{className:"flex items-center justify-center h-24",children:e.jsx("div",{className:"h-5 w-5 animate-spin rounded-full border-2 border-primary border-t-transparent"})}):e.jsx("div",{className:`grid ${a.gridCols} gap-3`,children:a.statusOrder.map(r=>{const s=r.toUpperCase(),t=a.statusConfig[s];if(!t)return null;const l=t.icon,E=y[r]||0;return e.jsx(T,{className:`${t.bgColor} border cursor-pointer hover:shadow-md transition-shadow`,onClick:()=>n(`${o.routePrefix}/all?status=${s}`),children:e.jsxs(P,{className:"p-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(l,{className:`h-4 w-4 ${t.color}`}),e.jsx("span",{className:`text-xl font-bold ${t.color}`,children:E})]}),e.jsx("p",{className:`mt-1 text-xs font-medium ${t.color}`,children:t.label})]})},r)})})]})]})}export{z as R,H as S};
