import{a as f,W as N,j as e,B as l,C as m,e as x}from"./index-_Sfdy-kJ.js";import{b as g}from"./status.constants-Dx3nRswF.js";import{e as v}from"./grpo.queries-DuEIYU8o.js";import{A as h}from"./arrow-left-GMhswg_J.js";import{S as y,R as b}from"./shield-x-BF_5sR6j.js";import{C as u}from"./circle-alert-g97mPIxl.js";import"./triangle-alert-DDbvsqNJ.js";import"./circle-x-Dqawni1P.js";import"./circle-check-D0318yXf.js";import"./clock-f8PItCJE.js";import"./useMutation-pgUcGbpY.js";const w=t=>{if(!t)return"-";try{return new Date(t).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}catch{return t}};function O(){const t=f(),{postingId:i}=N(),p=i?parseInt(i,10):null,{data:s,isLoading:o,error:n,refetch:j}=v(p),d=n,c=d?.status===403,r=s?g[s.status]:null;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(l,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0",onClick:()=>t("/grpo/history"),children:e.jsx(h,{className:"h-4 w-4"})}),e.jsx("h2",{className:"text-3xl font-bold tracking-tight",children:"Posting Detail"})]}),c&&e.jsxs("div",{className:"flex items-start gap-3 p-4 rounded-lg border border-destructive/50 bg-destructive/5",children:[e.jsx(y,{className:"h-5 w-5 text-destructive flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium text-destructive",children:"Permission Denied"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:d?.message||"You do not have permission to view this posting."})]})]}),n&&!c&&e.jsxs("div",{className:"flex items-start gap-3 p-4 rounded-lg border border-yellow-500/50 bg-yellow-50 dark:bg-yellow-900/10",children:[e.jsx(u,{className:"h-5 w-5 text-yellow-600 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium text-yellow-800 dark:text-yellow-400",children:"Failed to Load"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:d?.message||"An error occurred while loading posting detail."})]}),e.jsx(l,{variant:"outline",size:"sm",onClick:()=>j(),children:e.jsx(b,{className:"h-4 w-4"})})]}),o&&e.jsx("div",{className:"flex items-center justify-center h-48",children:e.jsx("div",{className:"h-8 w-8 animate-spin rounded-full border-4 border-primary border-t-transparent"})}),!o&&!n&&s&&e.jsxs(e.Fragment,{children:[e.jsx(m,{children:e.jsxs(x,{className:"p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"font-semibold",children:"Posting Information"}),r&&e.jsx("span",{className:`inline-flex items-center gap-1 rounded-full px-2 py-0.5 text-xs font-medium ${r.bgColor} ${r.color}`,children:r.label})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Entry No"}),e.jsx("p",{className:"font-medium",children:s.entry_no})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"PO Number"}),e.jsx("p",{className:"font-medium",children:s.po_number})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"SAP Doc Number"}),e.jsx("p",{className:"font-medium",children:s.sap_doc_num??"-"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"SAP Doc Entry"}),e.jsx("p",{className:"font-medium",children:s.sap_doc_entry??"-"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Total Value"}),e.jsx("p",{className:"font-medium",children:s.sap_doc_total?parseFloat(s.sap_doc_total).toLocaleString("en-IN",{style:"currency",currency:"INR"}):"-"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Posted At"}),e.jsx("p",{className:"font-medium",children:w(s.posted_at)})]})]}),s.error_message&&e.jsxs("div",{className:"flex items-start gap-2 p-3 rounded-md bg-destructive/5 border border-destructive/20",children:[e.jsx(u,{className:"h-4 w-4 text-destructive flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-destructive",children:"Error"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:s.error_message})]})]})]})}),s.lines&&s.lines.length>0&&e.jsx(m,{children:e.jsxs(x,{className:"p-4 space-y-3",children:[e.jsx("h3",{className:"font-semibold",children:"Posted Items"}),e.jsx("div",{className:"space-y-2",children:s.lines.map(a=>e.jsxs("div",{className:"flex items-center justify-between p-2 rounded-md border bg-muted/30",children:[e.jsx("div",{children:e.jsxs("p",{className:"text-sm font-medium",children:[a.item_code," - ",a.item_name]})}),e.jsx("span",{className:"text-sm font-semibold",children:a.quantity_posted})]},a.id))})]})}),e.jsxs(l,{variant:"outline",onClick:()=>t("/grpo/history"),children:[e.jsx(h,{className:"h-4 w-4 mr-2"}),"Back to History"]})]})]})}export{O as default};
