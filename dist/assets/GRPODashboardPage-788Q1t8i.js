import{y as f,a as v,j as e,B as i,C as h,e as p,am as k,_ as d}from"./index-BXj2xmF-.js";import{G as a}from"./status.constants-DblycgmX.js";import{u as C,a as P}from"./grpo.queries-DiulGez7.js";import{S as _,R as g}from"./shield-x-DOzpI-2T.js";import{C as E}from"./circle-alert-CwYuiYxM.js";import{C as R}from"./circle-x-DlTLaIKm.js";import{C as S}from"./circle-check-9RHos3U3.js";import{C as O}from"./clock-Bry0vFt7.js";import"./triangle-alert-C0WerlVv.js";import"./useMutation-D1xWQeEl.js";const A=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]],D=f("history",A);const G=[["path",{d:"M3 5h.01",key:"18ugdj"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 19h.01",key:"noohij"}],["path",{d:"M8 5h13",key:"1pao27"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 19h13",key:"m83p4d"}]],u=f("list",G),L={pending:{label:"Pending",color:"text-yellow-600 dark:text-yellow-400",bgColor:"bg-yellow-50 dark:bg-yellow-900/20 border-yellow-200 dark:border-yellow-800",icon:O,link:"/grpo/history?status=pending"},posted:{label:"Posted",color:"text-green-600 dark:text-green-400",bgColor:"bg-green-50 dark:bg-green-900/20 border-green-200 dark:border-green-800",icon:S,link:"/grpo/history?status=posted"},failed:{label:"Failed",color:"text-red-600 dark:text-red-400",bgColor:"bg-red-50 dark:bg-red-900/20 border-red-200 dark:border-red-800",icon:R,link:"/grpo/history?status=failed"}},M=["pending","posted","failed"],T=t=>{if(!t)return"-";try{return new Date(t).toLocaleString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}catch{return t}};function Q(){const t=v(),{data:n=[],isLoading:j,error:c,refetch:m}=C(),{data:o=[]}=P(),l=c,x=l?.status===403,N=n.reduce((s,r)=>s+r.pending_po_count,0),y={pending:o.filter(s=>s.status===a.PENDING).length,posted:o.filter(s=>s.status===a.POSTED).length,failed:o.filter(s=>s.status===a.FAILED||s.status===a.PARTIALLY_POSTED).length};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl font-bold tracking-tight",children:"GRPO Posting"}),e.jsx("p",{className:"text-muted-foreground",children:"Post goods receipts to SAP after gate entry completion"})]}),e.jsxs(i,{onClick:()=>t("/grpo/pending"),className:"w-full sm:w-auto",children:[e.jsx(u,{className:"h-4 w-4 mr-2"}),"View Pending"]})]}),j?e.jsx("div",{className:"flex items-center justify-center h-48",children:e.jsx("div",{className:"h-8 w-8 animate-spin rounded-full border-4 border-primary border-t-transparent"})}):e.jsxs(e.Fragment,{children:[x&&e.jsxs("div",{className:"flex items-start gap-3 p-4 rounded-lg border border-destructive/50 bg-destructive/5",children:[e.jsx(_,{className:"h-5 w-5 text-destructive flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium text-destructive",children:"Permission Denied"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:l?.message||"You do not have permission to view this data."})]}),e.jsx(i,{variant:"outline",size:"sm",onClick:()=>m(),children:e.jsx(g,{className:"h-4 w-4"})})]}),c&&!x&&e.jsxs("div",{className:"flex items-start gap-3 p-4 rounded-lg border border-yellow-500/50 bg-yellow-50 dark:bg-yellow-900/10",children:[e.jsx(E,{className:"h-5 w-5 text-yellow-600 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium text-yellow-800 dark:text-yellow-400",children:"Failed to Load"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:l?.message||"An error occurred while loading the dashboard."})]}),e.jsx(i,{variant:"outline",size:"sm",onClick:()=>m(),children:e.jsx(g,{className:"h-4 w-4"})})]}),e.jsx(h,{className:"bg-primary/5 border-primary/20 cursor-pointer hover:shadow-md transition-shadow",onClick:()=>t("/grpo/pending"),children:e.jsxs(p,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(k,{className:"h-5 w-5 text-primary"}),e.jsx("span",{className:"text-sm font-medium text-primary",children:"Pending GRPO"})]}),e.jsx("span",{className:"text-3xl font-bold text-primary",children:n.length})]}),e.jsxs("div",{className:"mt-3 pt-3 border-t border-primary/20 flex items-center justify-between text-sm text-muted-foreground",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("span",{children:[e.jsx("span",{className:"font-semibold text-yellow-600 dark:text-yellow-400",children:N})," ","POs pending"]}),e.jsxs("span",{children:[e.jsx("span",{className:"font-semibold text-primary",children:n.length})," ","Entries"]})]}),e.jsx(d,{className:"h-4 w-4"})]})]})}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h3",{className:"text-sm font-medium text-muted-foreground",children:"Recent Pending Entries"}),e.jsxs("button",{onClick:()=>t("/grpo/pending"),className:"text-xs text-muted-foreground hover:text-foreground transition-colors flex items-center gap-1",children:["Show more",e.jsx(d,{className:"h-3 w-3"})]})]}),n.length===0?e.jsx("div",{className:"flex items-center justify-center h-16 text-sm text-muted-foreground border rounded-lg",children:"No pending entries"}):e.jsx("div",{className:"space-y-2",children:n.slice(0,5).map(s=>e.jsxs("div",{className:"flex items-center justify-between px-3 py-2 rounded-md border bg-card hover:bg-muted/50 transition-colors cursor-pointer",onClick:()=>t(`/grpo/preview/${s.vehicle_entry_id}`),children:[e.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[e.jsx("span",{className:"font-medium text-sm",children:s.entry_no}),e.jsxs("span",{className:"inline-flex items-center rounded-full px-1.5 py-0.5 text-[10px] font-medium bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-400",children:[s.pending_po_count," PO",s.pending_po_count!==1?"s":""," pending"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xs text-muted-foreground",children:T(s.entry_time)}),e.jsx(d,{className:"h-4 w-4 text-muted-foreground"})]})]},s.vehicle_entry_id))})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-muted-foreground mb-3",children:"Posting History"}),e.jsx("div",{className:"grid grid-cols-3 gap-3",children:M.map(s=>{const r=L[s],b=r.icon,w=y[s]||0;return e.jsx(h,{className:`${r.bgColor} border cursor-pointer hover:shadow-md transition-shadow`,onClick:()=>t(r.link),children:e.jsxs(p,{className:"p-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(b,{className:`h-4 w-4 ${r.color}`}),e.jsx("span",{className:`text-xl font-bold ${r.color}`,children:w})]}),e.jsx("p",{className:`mt-1 text-xs font-medium ${r.color}`,children:r.label})]})},s)})})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-muted-foreground mb-3",children:"Quick Actions"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs(i,{variant:"outline",className:"h-auto py-3 flex flex-col items-center gap-1",onClick:()=>t("/grpo/pending"),children:[e.jsx(u,{className:"h-5 w-5"}),e.jsx("span",{className:"text-xs",children:"Pending Entries"})]}),e.jsxs(i,{variant:"outline",className:"h-auto py-3 flex flex-col items-center gap-1",onClick:()=>t("/grpo/history"),children:[e.jsx(D,{className:"h-5 w-5"}),e.jsx("span",{className:"text-xs",children:"Posting History"})]})]})]})]})]})}export{Q as default};
