import{y as b,a as N,j as e,B as a,C as i,e as l,Y as g,b as o,c as d}from"./index--0m_tC-m.js";import{u as v,P as h}from"./personGateIn.queries-BTohqNll.js";import{P as k}from"./plus-DY4R3w0n.js";import{U as w}from"./user-check-CCdTpowE.js";import{T as y}from"./triangle-alert-Ct0rFQMW.js";import{C as _}from"./clock-0WkAfDVu.js";import{U as n}from"./users-B1lSF-GU.js";import"./useMutation-DO4goLdQ.js";const C=[["path",{d:"m10 17 5-5-5-5",key:"1bsop3"}],["path",{d:"M15 12H3",key:"6jk70r"}],["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}]],I=b("log-in",C),L=r=>{switch(r){case"IN":return"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400";case"OUT":return"bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-400";case"CANCELLED":return"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-400";default:return"bg-gray-100 text-gray-800 dark:bg-gray-800 dark:text-gray-300"}};function S(){const r=N(),{data:t,isLoading:p}=v(),j=s=>{if(!s)return"-";try{return new Date(s).toLocaleString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}catch{return s}},f=s=>{if(!s)return"-";try{const c=new Date(s),x=new Date().getTime()-c.getTime(),m=Math.floor(x/(1e3*60*60)),u=Math.floor(x%(1e3*60*60)/(1e3*60));return m>0?`${m}h ${u}m`:`${u}m`}catch{return"-"}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl font-bold tracking-tight",children:"Visitor/Labour"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage visitor and labour gate entries"})]}),e.jsxs(a,{onClick:()=>r("/gate/visitor-labour/new"),className:"w-full sm:w-auto",children:[e.jsx(k,{className:"h-4 w-4 mr-2"}),"New Entry"]})]}),p?e.jsx("div",{className:"flex items-center justify-center h-48",children:e.jsx("div",{className:"h-8 w-8 animate-spin rounded-full border-4 border-primary border-t-transparent"})}):e.jsxs(e.Fragment,{children:[e.jsx(i,{className:"bg-green-50 dark:bg-green-900/20 border-green-200 dark:border-green-800 cursor-pointer hover:shadow-md transition-shadow",onClick:()=>r("/gate/visitor-labour/inside"),children:e.jsxs(l,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(w,{className:"h-5 w-5 text-green-600 dark:text-green-400"}),e.jsx("span",{className:"text-sm font-medium text-green-600 dark:text-green-400",children:"Total Inside Now"})]}),e.jsx("span",{className:"text-3xl font-bold text-green-600 dark:text-green-400",children:t?.current.total_inside??0})]}),e.jsxs("div",{className:"mt-3 pt-3 border-t border-green-200 dark:border-green-800 flex items-center justify-between text-sm text-muted-foreground",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("span",{children:[e.jsx("span",{className:"font-semibold text-purple-600 dark:text-purple-400",children:t?.current.visitors_inside??0})," ","Visitors"]}),e.jsxs("span",{children:[e.jsx("span",{className:"font-semibold text-orange-600 dark:text-orange-400",children:t?.current.labours_inside??0})," ","Labours"]})]}),(t?.current.long_duration_count??0)>0&&e.jsxs("span",{className:"flex items-center gap-1 text-amber-600 dark:text-amber-400",children:[e.jsx(y,{className:"h-3.5 w-3.5"}),e.jsx("span",{className:"font-semibold",children:t?.current.long_duration_count})," ","Long Duration"]})]})]})}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h3",{className:"text-sm font-medium text-muted-foreground",children:"Recent Entries"}),e.jsxs("button",{onClick:()=>r("/gate/visitor-labour/all"),className:"text-xs text-muted-foreground hover:text-foreground transition-colors flex items-center gap-1",children:["View all",e.jsx(g,{className:"h-3 w-3"})]})]}),!t?.recent_entries||t.recent_entries.length===0?e.jsx("div",{className:"flex items-center justify-center h-24 text-sm text-muted-foreground border rounded-lg",children:"No recent entries"}):e.jsx("div",{className:"space-y-2",children:t.recent_entries.slice(0,3).map(s=>e.jsxs("div",{className:"flex items-center justify-between px-3 py-2 rounded-md border bg-card hover:bg-muted/50 transition-colors cursor-pointer",onClick:()=>r(`/gate/visitor-labour/entry/${s.id}`),children:[e.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium text-sm",children:s.name_snapshot}),e.jsx("span",{className:`inline-flex items-center rounded-full px-1.5 py-0.5 text-[10px] font-medium ${L(s.status)}`,children:s.status})]}),s.purpose&&e.jsx("span",{className:"text-xs text-muted-foreground hidden sm:inline truncate max-w-[150px]",children:s.purpose})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"text-right hidden sm:block",children:[e.jsx("span",{className:"text-xs text-muted-foreground",children:j(s.entry_time)}),s.status==="IN"&&e.jsxs("span",{className:"text-xs text-green-600 dark:text-green-400 ml-2",children:["(",f(s.entry_time),")"]})]}),e.jsx(g,{className:"h-4 w-4 text-muted-foreground"})]})]},s.id))})]}),e.jsxs(i,{children:[e.jsx(o,{className:"pb-2",children:e.jsxs(d,{className:"text-base font-medium flex items-center gap-2",children:[e.jsx(_,{className:"h-4 w-4"}),"Today's Activity"]})}),e.jsx(l,{children:e.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"text-center p-3 rounded-lg bg-muted/50 cursor-pointer hover:bg-muted transition-colors",onClick:()=>r("/gate/visitor-labour/all"),children:[e.jsx("div",{className:"text-2xl font-bold",children:t?.today.total_entries??0}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Total Entries"})]}),e.jsxs("div",{className:"text-center p-3 rounded-lg bg-muted/50 cursor-pointer hover:bg-muted transition-colors",onClick:()=>r(`/gate/visitor-labour/all?person_type=${h.VISITOR}`),children:[e.jsx("div",{className:"text-2xl font-bold text-purple-600 dark:text-purple-400",children:t?.today.visitors??0}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Visitors"})]}),e.jsxs("div",{className:"text-center p-3 rounded-lg bg-muted/50 cursor-pointer hover:bg-muted transition-colors",onClick:()=>r(`/gate/visitor-labour/all?person_type=${h.LABOUR}`),children:[e.jsx("div",{className:"text-2xl font-bold text-orange-600 dark:text-orange-400",children:t?.today.labours??0}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Labours"})]}),e.jsxs("div",{className:"text-center p-3 rounded-lg bg-muted/50 cursor-pointer hover:bg-muted transition-colors",onClick:()=>r("/gate/visitor-labour/all?status=OUT"),children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600 dark:text-blue-400",children:t?.today.exits??0}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Exits"})]})]})})]}),e.jsxs("div",{className:"grid lg:grid-cols-2 gap-4",children:[t?.gate_wise&&t.gate_wise.length>0&&e.jsxs(i,{children:[e.jsx(o,{className:"pb-2",children:e.jsxs(d,{className:"text-base font-medium flex items-center gap-2",children:[e.jsx(I,{className:"h-4 w-4"}),"Gate-wise Inside Count"]})}),e.jsx(l,{children:e.jsx("div",{className:"space-y-2",children:t.gate_wise.map(s=>e.jsxs("div",{className:"flex items-center justify-between p-2 rounded-lg bg-muted/30 cursor-pointer hover:bg-muted transition-colors",onClick:()=>r(`/gate/visitor-labour/all?gate_in=${s.id}&status=IN`),children:[e.jsx("span",{className:"text-sm font-medium",children:s.name}),e.jsx("span",{className:"text-sm font-bold text-green-600 dark:text-green-400",children:s.inside_count})]},s.id))})})]}),t?.person_type_wise&&t.person_type_wise.length>0&&e.jsxs(i,{children:[e.jsx(o,{className:"pb-2",children:e.jsxs(d,{className:"text-base font-medium flex items-center gap-2",children:[e.jsx(n,{className:"h-4 w-4"}),"Person Type Breakdown"]})}),e.jsx(l,{children:e.jsx("div",{className:"space-y-2",children:t.person_type_wise.map(s=>e.jsxs("div",{className:"flex items-center justify-between p-2 rounded-lg bg-muted/30 cursor-pointer hover:bg-muted transition-colors",onClick:()=>r(`/gate/visitor-labour/all?person_type=${s.id}`),children:[e.jsx("span",{className:"text-sm font-medium",children:s.name}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("span",{className:"text-xs text-muted-foreground",children:["Inside:"," ",e.jsx("span",{className:"font-bold text-green-600 dark:text-green-400",children:s.inside_count})]}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:["Today: ",e.jsx("span",{className:"font-bold",children:s.today_count})]})]})]},s.id))})})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-muted-foreground mb-3",children:"Quick Actions"}),e.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-3",children:[e.jsxs(a,{variant:"outline",className:"h-auto py-3 flex flex-col items-center gap-1",onClick:()=>r("/gate/visitor-labour/new?type=visitor"),children:[e.jsx(n,{className:"h-5 w-5"}),e.jsx("span",{className:"text-xs",children:"Visitor Entry"})]}),e.jsxs(a,{variant:"outline",className:"h-auto py-3 flex flex-col items-center gap-1",onClick:()=>r("/gate/visitor-labour/new?type=labour"),children:[e.jsx(n,{className:"h-5 w-5"}),e.jsx("span",{className:"text-xs",children:"Labour Entry"})]}),e.jsxs(a,{variant:"outline",className:"h-auto py-3 flex flex-col items-center gap-1",onClick:()=>r("/gate/visitor-labour/visitors"),children:[e.jsx(n,{className:"h-5 w-5"}),e.jsx("span",{className:"text-xs",children:"Manage Visitors"})]}),e.jsxs(a,{variant:"outline",className:"h-auto py-3 flex flex-col items-center gap-1",onClick:()=>r("/gate/visitor-labour/labours"),children:[e.jsx(n,{className:"h-5 w-5"}),e.jsx("span",{className:"text-xs",children:"Manage Labours"})]})]})]})]})]})}export{S as default};
