import{a as k,z as C,r as c,E as y,j as e,B as h,I as L}from"./index-DVXWn1VN.js";import{a as _}from"./personGateIn.queries-B7DUntPc.js";import{D as P}from"./DateRangePicker-BrgtIdF4.js";import{A as S}from"./arrow-left-DuG4Sj7B.js";import{P as D}from"./plus-CnLwggQV.js";import{S as E}from"./search-nbZXUu-b.js";import"./useMutation-BYF3D-8F.js";function O(){const l=k(),[i]=C(),[r,f]=c.useState(""),{dateRange:o,dateRangeAsDateObjects:j,setDateRange:x}=y(),n=i.get("status")||void 0,d=i.get("person_type")||void 0,m=i.get("gate_in")||void 0,N=c.useMemo(()=>({from_date:o.from,to_date:o.to,status:n,person_type:d?Number(d):void 0,gate_in:m?Number(m):void 0}),[o,n,d,m]),{data:u=[],isLoading:b}=_(N),p=c.useMemo(()=>{let t=u;if(r.trim()){const s=r.toLowerCase();t=t.filter(a=>a.name_snapshot?.toLowerCase().includes(s)||a.status?.toLowerCase().includes(s)||a.remarks?.toLowerCase().includes(s)||a.purpose?.toLowerCase().includes(s)||a.gate_in?.name?.toLowerCase().includes(s)||a.vehicle_no?.toLowerCase().includes(s))}return t},[u,r]),g=t=>{if(!t)return"-";try{return new Date(t).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}catch{return t}},v=t=>{switch(t?.toUpperCase()){case"IN":return"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400";case"OUT":return"bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-400";case"CANCELLED":return"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-400";default:return"bg-gray-100 text-gray-800 dark:bg-gray-800 dark:text-gray-300"}},w=t=>{switch(t?.toUpperCase()){case"VISITOR":return"bg-purple-100 text-purple-800 dark:bg-purple-900/30 dark:text-purple-400";case"LABOUR":return"bg-orange-100 text-orange-800 dark:bg-orange-900/30 dark:text-orange-400";default:return"bg-gray-100 text-gray-800 dark:bg-gray-800 dark:text-gray-300"}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(h,{variant:"ghost",size:"icon",onClick:()=>l("/gate/visitor-labour"),children:e.jsx(S,{className:"h-4 w-4"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl font-bold tracking-tight",children:"All Entries"}),e.jsxs("p",{className:"text-muted-foreground",children:["View all visitor and labour gate entries",n&&e.jsxs("span",{className:"ml-2 text-sm",children:["(Filtered by: ",e.jsx("span",{className:"font-medium",children:n}),")"]})]})]})]}),e.jsxs(h,{onClick:()=>l("/gate/visitor-labour/new"),className:"w-full sm:w-auto",children:[e.jsx(D,{className:"h-4 w-4 mr-2"}),"New Entry"]})]}),e.jsxs("div",{className:"flex flex-col gap-4 sm:flex-row sm:items-center",children:[e.jsxs("div",{className:"relative flex-1 max-w-sm",children:[e.jsx(E,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),e.jsx(L,{placeholder:"Search by name, purpose, gate...",value:r,onChange:t=>f(t.target.value),className:"pl-10"})]}),e.jsx("div",{className:"w-full sm:w-auto",children:e.jsx(P,{date:j,onDateChange:t=>{t&&"from"in t?x(t):x(void 0)},mode:"range"})})]}),b?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"h-8 w-8 animate-spin rounded-full border-4 border-primary border-t-transparent"})}):p.length===0?e.jsx("div",{className:"flex flex-col items-center justify-center h-64 text-muted-foreground rounded-md border",children:e.jsx("p",{className:"text-lg",children:"No entries found"})}):e.jsx("div",{className:"rounded-md border overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto max-w-full",children:e.jsxs("table",{className:"w-full min-w-[800px]",children:[e.jsx("thead",{className:"bg-muted/50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-3 text-left text-sm font-medium",children:"Name"}),e.jsx("th",{className:"p-3 text-left text-sm font-medium",children:"Type"}),e.jsx("th",{className:"p-3 text-left text-sm font-medium",children:"Gate In"}),e.jsx("th",{className:"p-3 text-left text-sm font-medium",children:"Entry Time"}),e.jsx("th",{className:"p-3 text-left text-sm font-medium",children:"Exit Time"}),e.jsx("th",{className:"p-3 text-left text-sm font-medium",children:"Status"}),e.jsx("th",{className:"p-3 text-left text-sm font-medium",children:"Purpose"})]})}),e.jsx("tbody",{children:p.map(t=>e.jsxs("tr",{className:"border-t hover:bg-muted/50 transition-colors cursor-pointer",onClick:()=>{l(`/gate/visitor-labour/entry/${t.id}`)},children:[e.jsx("td",{className:"p-3 text-sm font-medium",children:t.name_snapshot||"-"}),e.jsx("td",{className:"p-3 text-sm",children:e.jsx("span",{className:`inline-flex items-center rounded-full px-2 py-0.5 text-xs font-medium ${w(t.person_type?.name||(t.visitor?"Visitor":"Labour"))}`,children:t.person_type?.name||(t.visitor?"Visitor":"Labour")})}),e.jsx("td",{className:"p-3 text-sm",children:t.gate_in?.name||"-"}),e.jsx("td",{className:"p-3 text-sm text-muted-foreground",children:g(t.entry_time)}),e.jsx("td",{className:"p-3 text-sm text-muted-foreground",children:g(t.exit_time)}),e.jsx("td",{className:"p-3 text-sm",children:e.jsx("span",{className:`inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-medium ${v(t.status||"")}`,children:t.status||"-"})}),e.jsx("td",{className:"p-3 text-sm text-muted-foreground max-w-[200px] truncate",children:t.purpose||"-"})]},t.id))})]})})})]})}export{O as default};
