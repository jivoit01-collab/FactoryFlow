import{am as C,j as e,a as k,r as m,an as A,B as x,ao as P,ap as S,J as j,M,aq as _,ar as E,Y as F}from"./index-BJbr7dGT.js";import{S as I}from"./send-CZEDXpPv.js";function L({children:o,permissions:t,companyRoles:l,requireAll:n=!1,fallback:a=null}){const{hasAnyPermission:i,hasAllPermissions:r,hasAnyCompanyRole:f,permissionsLoaded:d}=C();return d?l&&l.length>0&&!f(l)?e.jsx(e.Fragment,{children:a}):t&&t.length>0&&!(n?r(t):i(t))?e.jsx(e.Fragment,{children:a}):e.jsx(e.Fragment,{children:o}):e.jsx(e.Fragment,{children:a})}const N=20;function z(o){const t=new Date,l=new Date(o),n=t.getTime()-l.getTime(),a=Math.floor(n/6e4),i=Math.floor(a/60),r=Math.floor(i/24);return a<1?"Just now":a<60?`${a}m ago`:i<24?`${i}h ago`:r<7?`${r}d ago`:l.toLocaleDateString()}function $(){const o=k(),[t,l]=m.useState("all"),[n,a]=m.useState(0),{notifications:i,unreadCount:r,totalCount:f,isLoading:d,loadNotifications:u,markAsRead:v,markAllAsRead:b}=A(),p=m.useCallback((s,c)=>{const g={limit:N,offset:s*N};c==="unread"&&(g.is_read=!1),c==="read"&&(g.is_read=!0),u(g)},[u]);m.useEffect(()=>{p(n,t)},[n,t,p]);const w=s=>{l(s),a(0)},y=s=>{s.is_read||v([s.id])},h=Math.ceil(f/N);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl font-bold tracking-tight",children:"Notifications"}),e.jsx("p",{className:"text-muted-foreground",children:r>0?`You have ${r} unread notification${r!==1?"s":""}`:"All caught up"})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[r>0&&e.jsxs(x,{variant:"outline",size:"sm",onClick:()=>b(),children:[e.jsx(P,{className:"mr-2 h-4 w-4"}),"Mark all as read"]}),e.jsx(L,{permissions:[S.SEND],children:e.jsxs(x,{size:"sm",onClick:()=>o("/notifications/send"),children:[e.jsx(I,{className:"mr-2 h-4 w-4"}),"Send Notification"]})})]})]}),e.jsx("div",{className:"flex gap-1 rounded-lg border bg-muted p-1 w-fit",children:[{key:"all",label:"All"},{key:"unread",label:"Unread"},{key:"read",label:"Read"}].map(({key:s,label:c})=>e.jsx("button",{type:"button",onClick:()=>w(s),className:j("rounded-md px-3 py-1.5 text-sm font-medium transition-colors",t===s?"bg-background text-foreground shadow-sm":"text-muted-foreground hover:text-foreground"),children:c},s))}),e.jsx("div",{className:"rounded-lg border",children:d&&i.length===0?e.jsx("div",{className:"flex items-center justify-center py-16",children:e.jsx(M,{className:"h-6 w-6 animate-spin text-muted-foreground"})}):i.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center py-16 text-muted-foreground",children:[e.jsx(_,{className:"mb-3 h-10 w-10 opacity-50"}),e.jsx("p",{className:"text-sm",children:t==="unread"?"No unread notifications":t==="read"?"No read notifications":"No notifications yet"})]}):e.jsx("div",{className:"divide-y",children:i.map(s=>e.jsx("button",{type:"button",onClick:()=>y(s),className:j("flex w-full gap-3 px-4 py-4 text-left transition-colors hover:bg-accent sm:px-6",!s.is_read&&"bg-accent/50"),children:e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsx("p",{className:j("text-sm",s.is_read?"font-medium":"font-semibold"),children:s.title}),e.jsxs("div",{className:"flex items-center gap-2 shrink-0",children:[e.jsx("span",{className:"text-xs text-muted-foreground/70",children:z(s.created_at)}),!s.is_read&&e.jsx("span",{className:"h-2 w-2 rounded-full bg-primary"})]})]}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:s.body})]})},s.id))})}),h>1&&e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Page ",n+1," of ",h]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(x,{variant:"outline",size:"sm",onClick:()=>a(s=>s-1),disabled:n===0||d,children:[e.jsx(E,{className:"h-4 w-4 mr-1"}),"Previous"]}),e.jsxs(x,{variant:"outline",size:"sm",onClick:()=>a(s=>s+1),disabled:n>=h-1||d,children:["Next",e.jsx(F,{className:"h-4 w-4 ml-1"})]})]})]})]})}export{$ as default};
