{
  "permissions": {
    "allow": [
      "Bash(tree:*)",
      "Bash(git mv:*)",
      "Bash(npm run type-check:*)",
      "Bash(npx tsc:*)",
      "Bash(npm run build:*)",
      "Bash(npm run lint)",
      "Bash(npx eslint:*)",
      "Bash(npm install:*)",
      "Bash(dir:*)",
      "Bash(npx vite build)",
      "Bash(echo:*)",
      "Bash(ls:*)",
      "Bash(findstr:*)",
      "Bash(powershell -Command:*)",
      "Bash(find:*)",
      "mcp__ide__getDiagnostics",
      "Bash(wc:*)",
      "Bash(npx vitest:*)",
      "Bash(node -e:*)",
      "Bash(cd:*)",
      "Bash(\"c:\\\\Users\\\\Rohit Rathod\\\\Desktop\\\\Devlopment\\\\FactoryFlow\\\\src\\\\modules\\\\auth\\\\tests\\\\pages\\\\LoginPage.test.tsx\" << 'TESTEOF'\nimport { describe, it, expect, vi, beforeEach } from 'vitest'\nimport { render, screen, waitFor } from '@testing-library/react'\n\n// ═══════════════════════════════════════════════════════════════\n// Mocks\n// ═══════════════════════════════════════════════════════════════\n\nconst mockNavigate = vi.fn\\(\\)\nvi.mock\\('react-router-dom', \\(\\) => \\({\n  useNavigate: \\(\\) => mockNavigate,\n}\\)\\)\n\nconst mockDispatch = vi.fn\\(\\)\nvi.mock\\('@/core/store', \\(\\) => \\({\n  useAppDispatch: \\(\\) => mockDispatch,\n}\\)\\)\n\nvi.mock\\('@/core/auth', \\(\\) => \\({\n  loginSuccess: vi.fn\\(\\(payload: any\\) => \\({ type: 'auth/loginSuccess', payload }\\)\\),\n}\\)\\)\n\nconst mockLogin = vi.fn\\(\\)\nvi.mock\\('@/core/auth/services/auth.service', \\(\\) => \\({\n  authService: {\n    login: \\(...args: any[]\\) => mockLogin\\(...args\\),\n  },\n}\\)\\)\n\nconst mockClearAuthData = vi.fn\\(\\)\nvi.mock\\('@/core/auth/services/indexedDb.service', \\(\\) => \\({\n  indexedDBService: {\n    clearAuthData: \\(...args: any[]\\) => mockClearAuthData\\(...args\\),\n  },\n}\\)\\)\n\nvi.mock\\('@/config/routes.config', \\(\\) => \\({\n  ROUTES: { COMPANY_SELECTION: { path: '/select-company' } },\n}\\)\\)\n\nvi.mock\\('@/config/constants', \\(\\) => \\({\n  APP_NAME: 'TestApp',\n}\\)\\)\n\nvi.mock\\('@/core/api/types', \\(\\) => \\({}\\)\\)\n\nconst DummyIcon = \\(\\) => null\nvi.mock\\('lucide-react', \\(\\) =>\n  new Proxy\\({ __esModule: true }, {\n    get: \\(_t, p\\) => \\(p === '__esModule' ? true : DummyIcon\\),\n  }\\)\n\\)\n\nvi.mock\\('@/shared/hooks', \\(\\) => \\({\n  useScrollToError: vi.fn\\(\\),\n}\\)\\)\n\n// Mock LoginForm to capture onSubmit and simulate form submission\nlet capturedOnSubmit: any = null\nvi.mock\\('@/modules/auth/components/LoginForm', \\(\\) => \\({\n  LoginForm: \\({ onSubmit, isLoading }: any\\) => {\n    capturedOnSubmit = onSubmit\n    return \\(\n      <div data-testid=\"login-form\">\n        <span>{isLoading ? 'loading' : 'ready'}</span>\n      </div>\n    \\)\n  },\n}\\)\\)\n\n// ═══════════════════════════════════════════════════════════════\n// Import after mocks\n// ═══════════════════════════════════════════════════════════════\n\nimport LoginPage from '@/modules/auth/pages/LoginPage'\n\ndescribe\\('LoginPage', \\(\\) => {\n  beforeEach\\(\\(\\) => {\n    vi.clearAllMocks\\(\\)\n    mockLogin.mockReset\\(\\)\n    mockClearAuthData.mockReset\\(\\)\n    capturedOnSubmit = null\n  }\\)\n\n  // ─── Rendering ────────────────────────────────────────────────\n\n  it\\('renders the app name', \\(\\) => {\n    render\\(<LoginPage />\\)\n\n    expect\\(screen.getByText\\('TestApp'\\)\\).toBeInTheDocument\\(\\)\n  }\\)\n\n  it\\('renders login description', \\(\\) => {\n    render\\(<LoginPage />\\)\n\n    expect\\(screen.getByText\\('Enter your credentials to access the system'\\)\\).toBeInTheDocument\\(\\)\n  }\\)\n\n  it\\('renders the login form', \\(\\) => {\n    render\\(<LoginPage />\\)\n\n    expect\\(screen.getByTestId\\('login-form'\\)\\).toBeInTheDocument\\(\\)\n  }\\)\n\n  it\\('renders the logo image', \\(\\) => {\n    render\\(<LoginPage />\\)\n\n    const logo = screen.getByAltText\\('Jivo Wellness Logo'\\)\n    expect\\(logo\\).toBeInTheDocument\\(\\)\n    expect\\(logo\\).toHaveAttribute\\('src', '/JivoWellnessLogo.png'\\)\n  }\\)\n\n  // ─── Login Flow ───────────────────────────────────────────────\n\n  it\\('clears IndexedDB, logs in, dispatches, and navigates on successful submit', async \\(\\) => {\n    mockClearAuthData.mockResolvedValueOnce\\(undefined\\)\n    const mockResponse = { access: 'token123', user: { id: 1 } }\n    mockLogin.mockResolvedValueOnce\\(mockResponse\\)\n\n    render\\(<LoginPage />\\)\n\n    // Simulate form submission through captured onSubmit\n    await capturedOnSubmit\\({ email: 'test@example.com', password: 'password123' }\\)\n\n    expect\\(mockClearAuthData\\).toHaveBeenCalled\\(\\)\n    expect\\(mockLogin\\).toHaveBeenCalledWith\\({\n      email: 'test@example.com',\n      password: 'password123',\n    }\\)\n    expect\\(mockDispatch\\).toHaveBeenCalled\\(\\)\n    expect\\(mockNavigate\\).toHaveBeenCalledWith\\('/select-company', { replace: true }\\)\n  }\\)\n\n  // ─── Error Handling ───────────────────────────────────────────\n\n  it\\('shows API error message on login failure', async \\(\\) => {\n    mockClearAuthData.mockResolvedValueOnce\\(undefined\\)\n    mockLogin.mockRejectedValueOnce\\({ message: 'Invalid credentials', status: 401 }\\)\n\n    render\\(<LoginPage />\\)\n\n    await capturedOnSubmit\\({ email: 'test@example.com', password: 'wrong' }\\)\n\n    await waitFor\\(\\(\\) => {\n      expect\\(screen.getByText\\('Invalid credentials'\\)\\).toBeInTheDocument\\(\\)\n    }\\)\n  }\\)\n\n  it\\('shows generic Error message on Error instance', async \\(\\) => {\n    mockClearAuthData.mockResolvedValueOnce\\(undefined\\)\n    mockLogin.mockRejectedValueOnce\\(new Error\\('Network error'\\)\\)\n\n    render\\(<LoginPage />\\)\n\n    await capturedOnSubmit\\({ email: 'test@example.com', password: 'password123' }\\)\n\n    await waitFor\\(\\(\\) => {\n      expect\\(screen.getByText\\('Network error'\\)\\).toBeInTheDocument\\(\\)\n    }\\)\n  }\\)\n\n  it\\('shows \"Login failed\" for unknown errors', async \\(\\) => {\n    mockClearAuthData.mockResolvedValueOnce\\(undefined\\)\n    mockLogin.mockRejectedValueOnce\\('something unexpected'\\)\n\n    render\\(<LoginPage />\\)\n\n    await capturedOnSubmit\\({ email: 'test@example.com', password: 'password123' }\\)\n\n    await waitFor\\(\\(\\) => {\n      expect\\(screen.getByText\\('Login failed'\\)\\).toBeInTheDocument\\(\\)\n    }\\)\n  }\\)\n}\\)\nTESTEOF)",
      "Bash(\"c:\\\\Users\\\\Rohit Rathod\\\\Desktop\\\\Devlopment\\\\FactoryFlow\\\\src\\\\modules\\\\auth\\\\tests\\\\pages\\\\ProfilePage.test.tsx\" << 'TESTEOF'\nimport { describe, it, expect, vi, beforeEach } from 'vitest'\nimport { render, screen } from '@testing-library/react'\n\n// ═══════════════════════════════════════════════════════════════\n// Mocks\n// ═══════════════════════════════════════════════════════════════\n\nconst mockNavigate = vi.fn\\(\\)\nvi.mock\\('react-router-dom', \\(\\) => \\({\n  useNavigate: \\(\\) => mockNavigate,\n}\\)\\)\n\nconst mockDispatch = vi.fn\\(\\)\nconst mockAuthState = {\n  user: {\n    full_name: 'John Doe',\n    email: 'john@example.com',\n    employee_code: 'EMP001',\n    is_active: true,\n    is_staff: true,\n    date_joined: '2024-01-15T00:00:00Z',\n    companies: [\n      {\n        company_id: 1,\n        company_name: 'Test Corp',\n        company_code: 'TC',\n        role: 'Admin',\n      },\n      {\n        company_id: 2,\n        company_name: 'Dev Corp',\n        company_code: 'DC',\n        role: 'Manager',\n      },\n    ],\n  },\n  permissions: ['accounts.add_user', 'accounts.view_user', 'gate.view_entry'],\n  currentCompany: {\n    company_id: 1,\n    company_name: 'Test Corp',\n    company_code: 'TC',\n    role: 'Admin',\n  },\n}\n\nvi.mock\\('@/core/store', \\(\\) => \\({\n  useAppDispatch: \\(\\) => mockDispatch,\n}\\)\\)\n\nvi.mock\\('@/core/auth', \\(\\) => \\({\n  useAuth: \\(\\) => \\({\n    user: mockAuthState.user,\n    permissions: mockAuthState.permissions,\n    logout: vi.fn\\(\\),\n    currentCompany: mockAuthState.currentCompany,\n  }\\),\n  clearCurrentCompany: vi.fn\\(\\),\n}\\)\\)\n\nvi.mock\\('@/core/auth/services/indexedDb.service', \\(\\) => \\({\n  indexedDBService: {\n    updateCurrentCompany: vi.fn\\(\\),\n  },\n}\\)\\)\n\nvi.mock\\('@/config/routes.config', \\(\\) => \\({\n  ROUTES: { COMPANY_SELECTION: { path: '/select-company' } },\n}\\)\\)\n\n// Mock ChangePasswordDialog to avoid deep dependency resolution\nvi.mock\\('@/modules/auth/components/ChangePasswordDialog', \\(\\) => \\({\n  ChangePasswordDialog: \\(\\) => <div data-testid=\"change-password-dialog\" />,\n}\\)\\)\n\n// ═══════════════════════════════════════════════════════════════\n// Import after mocks\n// ═══════════════════════════════════════════════════════════════\n\nimport ProfilePage from '@/modules/auth/pages/ProfilePage'\n\ndescribe\\('ProfilePage', \\(\\) => {\n  beforeEach\\(\\(\\) => {\n    vi.clearAllMocks\\(\\)\n  }\\)\n\n  // ─── User Info Rendering ──────────────────────────────────────\n\n  it\\('renders user full name', \\(\\) => {\n    render\\(<ProfilePage />\\)\n\n    expect\\(screen.getByText\\('John Doe'\\)\\).toBeInTheDocument\\(\\)\n  }\\)\n\n  it\\('renders user email', \\(\\) => {\n    render\\(<ProfilePage />\\)\n\n    expect\\(screen.getByText\\('john@example.com'\\)\\).toBeInTheDocument\\(\\)\n  }\\)\n\n  it\\('renders employee code', \\(\\) => {\n    render\\(<ProfilePage />\\)\n\n    expect\\(screen.getByText\\('EMP001'\\)\\).toBeInTheDocument\\(\\)\n  }\\)\n\n  it\\('renders user initials', \\(\\) => {\n    render\\(<ProfilePage />\\)\n\n    expect\\(screen.getByText\\('JD'\\)\\).toBeInTheDocument\\(\\)\n  }\\)\n\n  it\\('renders joined date', \\(\\) => {\n    render\\(<ProfilePage />\\)\n\n    // formatDate\\('2024-01-15T00:00:00Z'\\) => \"January 15, 2024\"\n    const dateText = screen.getByText\\(/January/\\)\n    expect\\(dateText\\).toBeInTheDocument\\(\\)\n  }\\)\n\n  it\\('renders Active badge when user is active', \\(\\) => {\n    render\\(<ProfilePage />\\)\n\n    expect\\(screen.getByText\\('Active'\\)\\).toBeInTheDocument\\(\\)\n  }\\)\n\n  it\\('renders Staff badge when user is staff', \\(\\) => {\n    render\\(<ProfilePage />\\)\n\n    expect\\(screen.getByText\\('Staff'\\)\\).toBeInTheDocument\\(\\)\n  }\\)\n\n  // ─── Companies/Roles ─────────────────────────────────────────\n\n  it\\('renders Roles section', \\(\\) => {\n    render\\(<ProfilePage />\\)\n\n    expect\\(screen.getByText\\('Roles'\\)\\).toBeInTheDocument\\(\\)\n  }\\)\n\n  it\\('renders company names', \\(\\) => {\n    render\\(<ProfilePage />\\)\n\n    expect\\(screen.getByText\\('Test Corp'\\)\\).toBeInTheDocument\\(\\)\n    expect\\(screen.getByText\\('Dev Corp'\\)\\).toBeInTheDocument\\(\\)\n  }\\)\n\n  it\\('renders company roles', \\(\\) => {\n    render\\(<ProfilePage />\\)\n\n    expect\\(screen.getByText\\('Admin'\\)\\).toBeInTheDocument\\(\\)\n    expect\\(screen.getByText\\('Manager'\\)\\).toBeInTheDocument\\(\\)\n  }\\)\n\n  it\\('shows \"Current\" badge on active company', \\(\\) => {\n    render\\(<ProfilePage />\\)\n\n    expect\\(screen.getByText\\('Current'\\)\\).toBeInTheDocument\\(\\)\n  }\\)\n\n  // ─── Permissions ──────────────────────────────────────────────\n\n  it\\('renders Permissions section', \\(\\) => {\n    render\\(<ProfilePage />\\)\n\n    expect\\(screen.getByText\\('Permissions'\\)\\).toBeInTheDocument\\(\\)\n  }\\)\n\n  it\\('renders permission app group labels', \\(\\) => {\n    render\\(<ProfilePage />\\)\n\n    expect\\(screen.getByText\\('accounts'\\)\\).toBeInTheDocument\\(\\)\n    expect\\(screen.getByText\\('gate'\\)\\).toBeInTheDocument\\(\\)\n  }\\)\n\n  it\\('renders formatted permission names', \\(\\) => {\n    render\\(<ProfilePage />\\)\n\n    expect\\(screen.getByText\\('Add User'\\)\\).toBeInTheDocument\\(\\)\n    expect\\(screen.getByText\\('View User'\\)\\).toBeInTheDocument\\(\\)\n    expect\\(screen.getByText\\('View Entry'\\)\\).toBeInTheDocument\\(\\)\n  }\\)\n\n  // ─── Action Buttons ──────────────────────────────────────────\n\n  it\\('renders Change Password button', \\(\\) => {\n    render\\(<ProfilePage />\\)\n\n    expect\\(screen.getByRole\\('button', { name: 'Change Password' }\\)\\).toBeInTheDocument\\(\\)\n  }\\)\n\n  it\\('renders Logout button', \\(\\) => {\n    render\\(<ProfilePage />\\)\n\n    expect\\(screen.getByRole\\('button', { name: 'Logout' }\\)\\).toBeInTheDocument\\(\\)\n  }\\)\n\n  it\\('renders Change Company button when currentCompany exists', \\(\\) => {\n    render\\(<ProfilePage />\\)\n\n    expect\\(screen.getByRole\\('button', { name: 'Change Company' }\\)\\).toBeInTheDocument\\(\\)\n  }\\)\n}\\)\nTESTEOF)",
      "Bash(\"c:\\\\Users\\\\Rohit Rathod\\\\Desktop\\\\Devlopment\\\\FactoryFlow\\\\src\\\\modules\\\\auth\\\\tests\\\\pages\\\\CompanySelectionPage.test.tsx\" << 'TESTEOF'\nimport { describe, it, expect, vi, beforeEach } from 'vitest'\nimport { render, screen, fireEvent, waitFor } from '@testing-library/react'\n\n// ═══════════════════════════════════════════════════════════════\n// Mocks\n// ═══════════════════════════════════════════════════════════════\n\nconst mockNavigate = vi.fn\\(\\)\nvi.mock\\('react-router-dom', \\(\\) => \\({\n  useNavigate: \\(\\) => mockNavigate,\n  useLocation: \\(\\) => \\({ state: null, pathname: '/select-company' }\\),\n}\\)\\)\n\nconst mockDispatch = vi.fn\\(\\)\nlet mockUser: any = {\n  companies: [\n    {\n      company_id: 1,\n      company_name: 'Alpha Corp',\n      company_code: 'AC',\n      role: 'Admin',\n    },\n    {\n      company_id: 2,\n      company_name: 'Beta Inc',\n      company_code: 'BI',\n      role: 'Manager',\n    },\n  ],\n}\n\nvi.mock\\('@/core/store', \\(\\) => \\({\n  useAppDispatch: \\(\\) => mockDispatch,\n  useAppSelector: \\(selector: any\\) => selector\\({ auth: { user: mockUser } }\\),\n}\\)\\)\n\nvi.mock\\('@/core/auth', \\(\\) => \\({\n  switchCompany: vi.fn\\(\\(company: any\\) => \\({ type: 'auth/switchCompany', payload: company }\\)\\),\n}\\)\\)\n\nconst mockUpdateCurrentCompany = vi.fn\\(\\)\nvi.mock\\('@/core/auth/services/indexedDb.service', \\(\\) => \\({\n  indexedDBService: {\n    updateCurrentCompany: \\(...args: any[]\\) => mockUpdateCurrentCompany\\(...args\\),\n  },\n}\\)\\)\n\nvi.mock\\('@/config/routes.config', \\(\\) => \\({\n  ROUTES: {\n    LOADING_USER: { path: '/loading-user' },\n  },\n}\\)\\)\n\nconst DummyIcon = \\(\\) => null\nvi.mock\\('lucide-react', \\(\\) =>\n  new Proxy\\({ __esModule: true }, {\n    get: \\(_t, p\\) => \\(p === '__esModule' ? true : DummyIcon\\),\n  }\\)\n\\)\n\n// ═══════════════════════════════════════════════════════════════\n// Import after mocks\n// ═══════════════════════════════════════════════════════════════\n\nimport CompanySelectionPage from '@/modules/auth/pages/CompanySelectionPage'\n\ndescribe\\('CompanySelectionPage', \\(\\) => {\n  beforeEach\\(\\(\\) => {\n    vi.clearAllMocks\\(\\)\n    mockUpdateCurrentCompany.mockReset\\(\\)\n    mockUser = {\n      companies: [\n        {\n          company_id: 1,\n          company_name: 'Alpha Corp',\n          company_code: 'AC',\n          role: 'Admin',\n        },\n        {\n          company_id: 2,\n          company_name: 'Beta Inc',\n          company_code: 'BI',\n          role: 'Manager',\n        },\n      ],\n    }\n  }\\)\n\n  // ─── Rendering ────────────────────────────────────────────────\n\n  it\\('renders the page title', \\(\\) => {\n    render\\(<CompanySelectionPage />\\)\n\n    expect\\(screen.getByText\\('Select Company'\\)\\).toBeInTheDocument\\(\\)\n  }\\)\n\n  it\\('renders the description', \\(\\) => {\n    render\\(<CompanySelectionPage />\\)\n\n    expect\\(screen.getByText\\('Choose a company to continue'\\)\\).toBeInTheDocument\\(\\)\n  }\\)\n\n  it\\('renders company cards', \\(\\) => {\n    render\\(<CompanySelectionPage />\\)\n\n    expect\\(screen.getByText\\('Alpha Corp'\\)\\).toBeInTheDocument\\(\\)\n    expect\\(screen.getByText\\('Beta Inc'\\)\\).toBeInTheDocument\\(\\)\n  }\\)\n\n  it\\('renders company roles and codes', \\(\\) => {\n    render\\(<CompanySelectionPage />\\)\n\n    expect\\(screen.getByText\\(/Admin/\\)\\).toBeInTheDocument\\(\\)\n    expect\\(screen.getByText\\(/AC/\\)\\).toBeInTheDocument\\(\\)\n  }\\)\n\n  it\\('renders continue button', \\(\\) => {\n    render\\(<CompanySelectionPage />\\)\n\n    expect\\(screen.getByRole\\('button', { name: 'Continue' }\\)\\).toBeInTheDocument\\(\\)\n  }\\)\n\n  it\\('disables continue button when no company is selected', \\(\\) => {\n    render\\(<CompanySelectionPage />\\)\n\n    expect\\(screen.getByRole\\('button', { name: 'Continue' }\\)\\).toBeDisabled\\(\\)\n  }\\)\n\n  // ─── No Companies ─────────────────────────────────────────────\n\n  it\\('shows no companies message when user has no companies', \\(\\) => {\n    mockUser = { companies: [] }\n\n    render\\(<CompanySelectionPage />\\)\n\n    expect\\(screen.getByText\\('No Companies Available'\\)\\).toBeInTheDocument\\(\\)\n  }\\)\n\n  it\\('shows no companies message when user is null', \\(\\) => {\n    mockUser = null\n\n    render\\(<CompanySelectionPage />\\)\n\n    expect\\(screen.getByText\\('No Companies Available'\\)\\).toBeInTheDocument\\(\\)\n  }\\)\n\n  // ─── Selection Flow ───────────────────────────────────────────\n\n  it\\('enables continue button after selecting a company', \\(\\) => {\n    render\\(<CompanySelectionPage />\\)\n\n    fireEvent.click\\(screen.getByText\\('Alpha Corp'\\)\\)\n\n    expect\\(screen.getByRole\\('button', { name: 'Continue' }\\)\\).not.toBeDisabled\\(\\)\n  }\\)\n\n  it\\('saves to IndexedDB and dispatches on continue', async \\(\\) => {\n    mockUpdateCurrentCompany.mockResolvedValueOnce\\(undefined\\)\n\n    render\\(<CompanySelectionPage />\\)\n\n    // Select a company\n    fireEvent.click\\(screen.getByText\\('Alpha Corp'\\)\\)\n\n    // Click continue\n    fireEvent.click\\(screen.getByRole\\('button', { name: 'Continue' }\\)\\)\n\n    await waitFor\\(\\(\\) => {\n      expect\\(mockUpdateCurrentCompany\\).toHaveBeenCalledWith\\(\n        expect.objectContaining\\({ company_id: 1, company_name: 'Alpha Corp' }\\)\n      \\)\n    }\\)\n\n    await waitFor\\(\\(\\) => {\n      expect\\(mockDispatch\\).toHaveBeenCalled\\(\\)\n    }\\)\n  }\\)\n\n  it\\('navigates to loading-user page after selection', async \\(\\) => {\n    mockUpdateCurrentCompany.mockResolvedValueOnce\\(undefined\\)\n\n    render\\(<CompanySelectionPage />\\)\n\n    fireEvent.click\\(screen.getByText\\('Alpha Corp'\\)\\)\n    fireEvent.click\\(screen.getByRole\\('button', { name: 'Continue' }\\)\\)\n\n    await waitFor\\(\\(\\) => {\n      expect\\(mockNavigate\\).toHaveBeenCalledWith\\('/loading-user', expect.objectContaining\\({ replace: true }\\)\\)\n    }\\)\n  }\\)\n}\\)\nTESTEOF)",
      "Bash(node audit.cjs:*)",
      "Bash(node scripts/fix-gate-pages.cjs:*)",
      "Bash(del \"c:\\\\Users\\\\Rohit Rathod\\\\Desktop\\\\Devlopment\\\\FactoryFlow\\\\src\\\\modules\\\\grpo\\\\__tests__\\\\pages\\\\_diagnostic.test.tsx\")"
    ]
  }
}
